(function(C,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react"],m):(C=typeof globalThis<"u"?globalThis:C||self,m(C.ReactFlexLayout={},C.React,C.React))})(this,(function(C,m,n){"use strict";const Ie=({size:e=16,color:t="#666",className:r=""})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[m.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),m.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),ye=({node:e,index:t,onClose:r,onSelect:l,onDragStart:s,onDragEnd:c,className:i="",style:h={},closeIcon:u,closeButtonClassName:f=""})=>{const v=n.useRef(!1),T=n.useCallback(()=>{l?.(e.id)},[e.id,l]),L=n.useCallback(w=>{w.stopPropagation(),r?.(e.id)},[e.id,r]),D=n.useCallback(w=>{w.dataTransfer.setData("text/plain",e.id),w.dataTransfer.effectAllowed="move",w.currentTarget.classList.add("dragging"),document.body.classList.add("dragging"),v.current=!0,s?.(e.id,t)},[e.id,t,s]),E=n.useCallback(w=>{w.currentTarget.classList.remove("dragging"),document.body.classList.remove("dragging"),v.current=!1,c?.()},[c]);n.useEffect(()=>()=>{v.current&&(document.body.classList.remove("dragging"),v.current=!1)},[]);const W=n.useMemo(()=>({...h,cursor:"grab"}),[h]);return m.jsxs("div",{className:`react-flex-layout-tab ${i}`,style:W,onClick:T,draggable:!0,onDragStart:D,onDragEnd:E,children:[m.jsx("span",{className:"react-flex-layout-tab-title",children:e.name||"Untitled"}),m.jsx("button",{className:`react-flex-layout-tab-close ${f}`.trim(),onClick:L,type:"button","aria-label":"Close tab",children:u||m.jsx(Ie,{})})]})},Ke=()=>m.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"15 18 9 12 15 6"})}),je=()=>m.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("polyline",{points:"9 18 15 12 9 6"})}),ke=({node:e,children:t,factory:r,onTabSelect:l,onTabClose:s,onTabDragStart:c,onTabDragEnd:i,onDragOver:h,onDragLeave:u,onDrop:f,dragOverTabset:v,dropPosition:T,dropTargetIndex:L,direction:D="ltr",className:E="",style:W={},closeIcon:w,closeButtonClassName:R,scrollLeftIcon:I,scrollRightIcon:N})=>{const d=n.useMemo(()=>e.children?.filter(o=>o.type==="tab")||[],[e.children]),y=n.useMemo(()=>{const o=new Map;for(let x=0;x<d.length;x++){const F=d[x];F&&F.id&&o.set(F.id,x)}return o},[d]),S=n.useMemo(()=>D==="rtl"?[...d].reverse():d,[d,D]),g=e.selected??0,$=Math.min(g,Math.max(0,d.length-1)),z=d[$],A=n.useCallback(o=>{const x=y.get(o);x!==void 0&&x!==-1&&l?.(e.id,x)},[e.id,y,l]),ne=n.useCallback(o=>{const x=y.get(o);x!==void 0&&x!==-1&&s?.(e.id,x)},[e.id,y,s]),P=n.useCallback((o,x)=>{const F=x!==void 0?x:y.get(o)??-1;F!==-1&&c?.(e.id,F)},[e.id,y,c]),ee=n.useRef(null),K=n.useRef(null),[ue,Y]=n.useState(!1),[he,de]=n.useState(!1),se=n.useRef(null),M=n.useCallback(o=>{o.preventDefault(),o.dataTransfer.dropEffect="move";const x=o.currentTarget.getBoundingClientRect(),F=o.clientX-x.left,a=o.clientY-x.top,p=x.width,V=x.height;let _="center";if(a<40){const re=ee.current;if(re){const Z=re.getBoundingClientRect(),le=o.clientX-Z.left,G=re.querySelectorAll(".react-flex-layout-tab");let H=d.length;if(D==="rtl"){for(let Q=G.length-1;Q>=0;Q--){const q=G[Q].getBoundingClientRect(),oe=q.left-Z.left,O=q.right-Z.left,ie=(oe+O)/2;if(le>ie){const U=y.get(S[Q].id);U!==void 0&&U!==-1&&(H=U);break}}if(H===d.length&&G.length>0){const Q=G[0].getBoundingClientRect();if(le>Q.right-Z.left){const q=y.get(S[0].id);q!==void 0&&q!==-1&&(H=q)}}}else for(let Q=0;Q<G.length;Q++){const q=G[Q].getBoundingClientRect(),oe=q.left-Z.left,O=q.right-Z.left,ie=(oe+O)/2;if(le<ie){const U=y.get(S[Q].id);U!==void 0&&U!==-1&&(H=U);break}}_="tab",h?.(o,e.id,_,H);return}}F<p*.25?_="left":F>p*.75?_="right":a<V*.25?_="top":a>V*.75?_="bottom":_="center",h?.(o,e.id,_)},[e.id,D,d.length,S,y,h]),B=n.useCallback(o=>{u?.(o)},[u]),j=n.useCallback(o=>{f?.(o,e.id)},[e.id,f]),k=v===e.id,X=n.useCallback(()=>{const o=K.current;if(!o){Y(!1),de(!1);return}const{scrollLeft:x,scrollWidth:F,clientWidth:a}=o;Y(x>1),de(x<F-a-1)},[]),ae=n.useCallback(()=>{se.current&&clearTimeout(se.current),se.current=setTimeout(X,10)},[X]);n.useEffect(()=>{const o=K.current;!o||$<0||requestAnimationFrame(()=>{const F=o.children[$];if(!F)return;const a=o.getBoundingClientRect(),p=F.getBoundingClientRect(),V=o.scrollLeft;p.left<a.left?o.scrollTo({left:V-(a.left-p.left)-10,behavior:"smooth"}):p.right>a.right&&o.scrollTo({left:V+(p.right-a.right)+10,behavior:"smooth"})})},[$,S.length]),n.useEffect(()=>{const o=K.current;if(!o)return;requestAnimationFrame(X),o.addEventListener("scroll",ae,{passive:!0});const x=new ResizeObserver(()=>{requestAnimationFrame(X)});return x.observe(o),()=>{o.removeEventListener("scroll",ae),x.disconnect(),se.current&&clearTimeout(se.current)}},[X,ae,S.length]);const be={...W,width:e.width?`${e.width}%`:void 0,height:e.height?`${e.height}%`:void 0,flex:`${e.flex||1} 1 0%`,minWidth:e.minWidth?`${e.minWidth}px`:void 0,minHeight:e.minHeight?`${e.minHeight}px`:void 0,maxWidth:e.maxWidth?`${e.maxWidth}px`:void 0,maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0};return d.length===0?null:m.jsxs("div",{className:`react-flex-layout-tabset ${k?"drag-over":""} ${E}`,style:be,"data-tabset-id":e.id,"data-drop-position":k?T:void 0,onDragOver:M,onDragLeave:B,onDrop:j,children:[m.jsxs("div",{className:"react-flex-layout-tabset-header",ref:ee,children:[ue&&m.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-left",onClick:()=>{const o=K.current;o&&o.scrollBy({left:-200,behavior:"smooth"})},type:"button","aria-label":"Scroll left",children:I||m.jsx(Ke,{})}),m.jsxs("div",{ref:K,className:"react-flex-layout-tabset-tabs-container",onScroll:ae,children:[S.map(o=>{const x=y.get(o.id)??-1,F=x===$,a=k&&T==="tab"&&L!==null&&x===L;return m.jsxs(n.Fragment,{children:[a&&m.jsx("div",{className:"react-flex-layout-tab-drop-indicator"}),m.jsx(ye,{node:o,index:x,onSelect:A,onClose:ne,onDragStart:P,onDragEnd:i,className:F?"active":"",closeIcon:w,closeButtonClassName:R})]},o.id)}),k&&T==="tab"&&L!==null&&L===d.length&&m.jsx("div",{className:"react-flex-layout-tab-drop-indicator"})]}),he&&m.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-right",onClick:()=>{const o=K.current;o&&o.scrollBy({left:200,behavior:"smooth"})},type:"button","aria-label":"Scroll right",children:N||m.jsx(je,{})})]}),m.jsx("div",{className:"react-flex-layout-tabset-content",children:z&&(r?r(z):t)})]})},Se=n.memo(ke,(e,t)=>{if(e.className!==t.className||e.direction!==t.direction||e.dragOverTabset!==t.dragOverTabset||e.dropPosition!==t.dropPosition||e.dropTargetIndex!==t.dropTargetIndex||e.factory!==t.factory||e.onTabSelect!==t.onTabSelect||e.onTabClose!==t.onTabClose||e.onTabDragStart!==t.onTabDragStart||e.onTabDragEnd!==t.onTabDragEnd||e.onDragOver!==t.onDragOver||e.onDragLeave!==t.onDragLeave||e.onDrop!==t.onDrop||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.style!==t.style||e.children!==t.children)return!1;if(e.node===t.node){if(e.node.selected!==t.node.selected)return!1}else{if(e.node.id!==t.node.id||e.node.selected!==t.node.selected||e.node.width!==t.node.width||e.node.height!==t.node.height||e.node.flex!==t.node.flex||e.node.minWidth!==t.node.minWidth||e.node.minHeight!==t.node.minHeight||e.node.maxWidth!==t.node.maxWidth||e.node.maxHeight!==t.node.maxHeight)return!1;const r=e.node.children||[],l=t.node.children||[];if(r!==l){if(r.length!==l.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==l[s]){const c=r[s],i=l[s];if(c.id!==i.id||c.type!==i.type||c.name!==i.name||c.component!==i.component||c.enableClose!==i.enableClose||c.enableDrag!==i.enableDrag)return!1}}}return!0});Se.displayName="MemoizedTabSet";const ve=({direction:e,onResize:t,onResizeStart:r,size:l=8,className:s="",style:c={},customStyles:i={}})=>{const[h,u]=n.useState(!1),f=n.useRef(0),v=n.useRef(0),T=n.useRef(!1),L=n.useRef(null),D=n.useRef(null),E=n.useCallback(I=>{I.preventDefault(),I.stopPropagation(),u(!0),f.current=e==="horizontal"?I.clientX:I.clientY,v.current=f.current,r?.();const N=y=>{v.current=e==="horizontal"?y.clientX:y.clientY,T.current||(T.current=!0,requestAnimationFrame(()=>{T.current=!1;const S=v.current-f.current;t(S)}))},d=()=>{u(!1),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",d),L.current=null,D.current=null,T.current=!1};document.addEventListener("mousemove",N),document.addEventListener("mouseup",d),L.current=N,D.current=d},[e,t,r]),W={backgroundColor:"#ffffff",border:"none",outline:"none"},w=n.useMemo(()=>h&&i.active?i.active:i.default?i.default:W,[h,i.active,i.default]),R=n.useMemo(()=>{const I=e==="horizontal";return{...c,width:I?`${l}px`:"100%",height:I?"100%":`${l}px`,minWidth:I?`${l}px`:void 0,minHeight:I?void 0:`${l}px`,flexShrink:0,cursor:I?"col-resize":"row-resize",...w,transition:h?"none":"all 0.2s ease"}},[e,l,c,w,h]);return n.useEffect(()=>()=>{L.current&&document.removeEventListener("mousemove",L.current),D.current&&document.removeEventListener("mouseup",D.current),T.current=!1},[]),m.jsx("div",{className:`react-flex-layout-splitter ${s}`,style:R,onMouseDown:E})},_e=(e,t)=>({global:{enableClose:!0,enableDrag:!0,enableResize:!0,splitterSize:8,tabOverlapLength:0,direction:"ltr",...t},layout:e}),Ee=(e,t,r,l)=>({id:e,type:"tab",component:t,name:r,config:l,enableClose:!0,enableDrag:!0}),Te=(e,t,r=0)=>({id:e,type:"tabset",children:t,selected:r,enableClose:!0,enableDrag:!0}),Ne=(e,t,r,l)=>({id:e,type:"row",children:Ce(t),width:r,height:l,enableResize:!0}),$e=(e,t,r,l)=>({id:e,type:"column",children:Ce(t),width:r,height:l,enableResize:!0}),te=(e,t)=>{if(e.id===t)return e;if(e.children)for(const r of e.children){const l=te(r,t);if(l)return l}return null},pe=(e,t)=>{if(!e.children)return null;for(const r of e.children)if(r.id===t)return e;for(const r of e.children){const l=pe(r,t);if(l)return l}return null},J=(e,t,r)=>{if(e.id===t)return r===null?null:Object.keys(r).some(s=>{const c=s;return e[c]!==r[c]})?{...e,...r}:e;if(e.children){let l=null;const s=e.children;for(let c=0;c<s.length;c++){const i=s[c],h=J(i,t,r);h!==i&&l===null&&(l=s.slice(0,c)),l!==null&&h!==null&&l.push(h)}return l===null?e:{...e,children:l}}return e},xe=(e,t)=>{if(!e.children)return e;let r=null;const l=e.children;for(let s=0;s<l.length;s++){const c=l[s];if(c.id===t){r===null&&(r=l.slice(0,s));continue}const i=xe(c,t);i!==c&&r===null&&(r=l.slice(0,s)),r!==null&&r.push(i)}return r===null?e:{...e,children:r}},Ce=e=>e.map(t=>({...t,flex:t.flex||1/e.length})),fe=e=>{if(e.type==="tabset"&&(!e.children||e.children.length===0))return null;if(e.children){const t=e.children,r=t.length;let l=null;for(let i=0;i<t.length;i++){const h=t[i],u=fe(h);u!==h&&l===null&&(l=t.slice(0,i)),l!==null&&u!==null&&l.push(u)}const s=l??t,c=s.length<r;if(s.length===0)return null;if((e.type==="row"||e.type==="column")&&s.length>0){const i=s.reduce((u,f)=>u+(f.flex||0),0);if(c||i<.999||s.length===1){let u;if(s.length===1)u=s.map(f=>({...f,flex:1}));else if(i===0||i<.001){const f=1/s.length;u=s.map(v=>({...v,flex:f}))}else{const f=1/i;u=s.map(v=>({...v,flex:(v.flex||0)*f}))}return{...e,children:u}}if(s.length!==r||s.some((u,f)=>u!==t[f]))return{...e,children:s}}if(l!==null)return{...e,children:s}}return e},ze=(e,t,r=null)=>{if(!e.children)return null;for(const l of e.children){if(l.id===t)return r||e;if(l.children){const s=ze(l,t,e);if(s)return s}}return null},He=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.type==="tabset"&&r.children&&r.children.find(s=>s.id===t))return r;if(r.children){const l=He(r,t);if(l)return l}}return null},Oe=(e,t,r)=>{const l=te(e,t);if(!l||l.type!=="tabset")return null;const c=[...l.children||[],r],i={...l,children:c,selected:c.length-1};return J(e,t,i)},qe=(e,t)=>{const r=He(e,t);if(!r||r.type!=="tabset")return{layout:e,restoreData:null};const l=r.children?.find(T=>T.id===t);if(!l||l.type!=="tab")return{layout:e,restoreData:null};const s=r.children?.findIndex(T=>T.id===t),c=r.children?.filter(T=>T.id!==t);if(!c||c.length===0){const T=xe(e,r.id),L={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:s!==void 0?s:0,config:l.config};return{layout:T,restoreData:L}}const i=r.selected??0;let h=i;s!==void 0&&s!==-1&&(s<=i&&(h=Math.max(0,i-1)),h=Math.min(h,c.length-1));const u={...r,children:c,selected:c.length>0?h:void 0},f=J(e,r.id,u),v={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:s!==void 0?s:0,config:l.config};return{layout:f,restoreData:v}},Je=(e,t,r)=>{if(te(e,t.tabId))return e;let s=te(e,t.tabsetId);if(!s||s.type!=="tabset"){if(!r)return null;const h=ze(r,t.tabsetId);if(!h)return null;const u=te(e,h.id);if(!u||!u.children)return null;const f=u.children.find(v=>v.id===t.tabsetId);if(f)s=f;else{const v=Te(t.tabsetId,[]),T=[...u.children,v],L={...u,children:T},D=J(e,u.id,L);if(!D||(e=D,s=te(e,t.tabsetId),!s||s.type!=="tabset"))return null}}const c=Ee(t.tabId,t.component,t.name,t.config);return Oe(e,t.tabsetId,c)},Xe=(e,t)=>te(e,t)!==null,Ue=(e,t)=>{const r=n.useRef({}),l=n.useRef({}),s=n.useCallback((i,h,u)=>{if(!t)return;const f=We(e.layout,i);if(!f||!f.children)return;const v=f.children.findIndex(S=>S.id===i),T=v+1;if(T>=f.children.length)return;const L=`${i}-${u}`;if(!r.current[L]){const S=f.children[v],g=f.children[T];r.current[L]={current:S.flex||1,sibling:g.flex||1}}const D=r.current[L],E=D.current+D.sibling,W=u==="horizontal"?window.innerWidth:window.innerHeight,w=D.current/E*W,R=D.sibling/E*W,I=100;let N=w+h,d=R-h;if(N<I){const S=I-N;N=I,d-=S}if(d<I){const S=I-d;d=I,N-=S}const y=N+d;if(y>0){const S=N/y*E,g=d/y*E,$=l.current[L],z=1e-4;if($&&Math.abs($.current-S)<z&&Math.abs($.sibling-g)<z)return;const A=f.children.slice(),ne=A[v],P=A[T];A[v]={...ne,flex:S},A[T]={...P,flex:g};const ee=J(e.layout,f.id,{children:A});ee&&(l.current[L]={current:S,sibling:g},t({...e,layout:ee}))}},[e,t]),c=n.useCallback((i,h)=>{const u=`${i}-${h}`;delete r.current[u],delete l.current[u]},[]);return{handleResize:s,resetResize:c}},We=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.id===t)return e;const l=We(r,t);if(l)return l}return null},Ye=(e,t)=>{const[r,l]=n.useState(null),[s,c]=n.useState(null),[i,h]=n.useState("center"),[u,f]=n.useState(null),v=n.useRef(null),T=n.useRef(e),L=n.useRef(t),D=n.useRef(i),E=n.useRef(u);n.useEffect(()=>{T.current=e},[e]),n.useEffect(()=>{L.current=t},[t]),n.useEffect(()=>{D.current=i},[i]),n.useEffect(()=>{E.current=u},[u]);const W=n.useCallback((d,y)=>{const S={tabsetId:d,tabIndex:y};l(S),v.current=S},[]),w=n.useCallback(()=>{l(null),v.current=null,c(null),f(null)},[]),R=n.useCallback((d,y,S="center",g)=>{d.preventDefault(),d.dataTransfer.dropEffect="move",c(y),h(S),g!==void 0?f(g):S!=="tab"&&f(null)},[]),I=n.useCallback(d=>{d.currentTarget===d.target&&setTimeout(()=>{c(null),f(null)},50)},[]),N=n.useCallback((d,y)=>{d.preventDefault();const S=v.current,g=T.current,$=L.current,z=D.current,A=E.current;if(!S||!$)return;const{tabsetId:ne,tabIndex:P}=S;if(ne===y&&z==="tab"&&A!==null){const M=te(g.layout,ne);if(!M||!M.children)return;const B=M.children[P];if(!B||P===A)return;const j=[...M.children];j.splice(P,1),j.splice(A,0,B);let k=M.selected??0;P<k&&A>=k?k=Math.max(0,k-1):P>k&&A<=k?k=Math.min(k+1,j.length-1):P===k&&(k=A);const X=J(g.layout,ne,{children:j,selected:k});X&&$({...g,layout:X,metadata:g.metadata}),l(null),c(null),f(null);return}if(ne===y&&z!=="tab")return;const ee=te(g.layout,ne),K=te(g.layout,y);if(!ee||!K||!ee.children||!K.children)return;const ue=ee.children[P];if(!ue)return;let Y=g.layout;const he=ee.children.filter((M,B)=>B!==P),de=J(Y,ne,{children:he,selected:Math.min(ee.selected||0,he.length-1)});if(!de)return;if(Y=de,z==="center"){const M=J(Y,y,{children:[...K.children||[],ue],selected:K.children?.length||0});if(!M)return;Y=M}else{const M=Te(`${y}-split-${Date.now()}`,[ue]),B=pe(Y,y);if(B){const j=B.children?.findIndex(k=>k.id===y)||0;if(z==="left"||z==="right"){const k=Ne(`${y}-row-${Date.now()}`,[z==="left"?M:K,z==="left"?K:M]),X=J(Y,B.id,{children:[...B.children?.slice(0,j)||[],k,...B.children?.slice(j+1)||[]]});if(!X)return;Y=X}else if(z==="top"||z==="bottom"){const k=$e(`${y}-column-${Date.now()}`,[z==="top"?M:K,z==="top"?K:M]),X=J(Y,B.id,{children:[...B.children?.slice(0,j)||[],k,...B.children?.slice(j+1)||[]]});if(!X)return;Y=X}}}const se=fe(Y);se&&$({...g,layout:se,metadata:g.metadata}),l(null),c(null)},[]);return{draggedTab:r,dragOverTabset:s,dropPosition:i,dropTargetIndex:u,handleDragStart:W,handleDragEnd:w,handleDragOver:R,handleDragLeave:I,handleDrop:N}},Ve="react-flex-layout";class Le{storageKey;autoSave;debounceMs;saveTimeout=null;lastSavedString=null;isAvailable;constructor(t={}){this.storageKey=`${Ve}-${t.key||"default"}`,this.autoSave=t.autoSave!==!1,this.debounceMs=t.debounceMs||500,this.isAvailable=Ae()}save(t){if(this.isAvailable)try{const r=JSON.stringify(t);if(r===this.lastSavedString)return;localStorage.setItem(this.storageKey,r),this.lastSavedString=r}catch{}}load(){if(!this.isAvailable)return null;try{const t=localStorage.getItem(this.storageKey);if(t)return this.lastSavedString=t,JSON.parse(t)}catch{}return null}clear(){if(this.isAvailable)try{localStorage.removeItem(this.storageKey),this.lastSavedString=null}catch{}}exists(){return this.isAvailable?localStorage.getItem(this.storageKey)!==null:!1}debouncedSave(t){this.autoSave&&this.isAvailable&&(this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.save(t)},this.debounceMs))}getStorageKey(){return this.storageKey}isAutoSaveEnabled(){return this.autoSave}cancel(){this.saveTimeout&&(clearTimeout(this.saveTimeout),this.saveTimeout=null)}}const Ge=e=>new Le(e),Ae=()=>{try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}},Me=(e,t={})=>{const{onLoad:r,onSave:l,onError:s,...c}=t,i=n.useRef(null),[h,u]=n.useState(e),[f,v]=n.useState(!1),[T,L]=n.useState(!1);n.useEffect(()=>{if(i.current)try{i.current.cancel?.()}catch{}i.current=new Le(c),L(!0)},[c.key,c.autoSave,c.debounceMs]),n.useEffect(()=>{if(!i.current||f)return;const g=i.current.load();g?(u(g),v(!0),r?.(g)):v(!0)},[f,r]);const D=n.useRef(),E=n.useMemo(()=>JSON.stringify(h.layout),[h.layout]),W=n.useMemo(()=>JSON.stringify(e.layout),[e.layout]),w=n.useMemo(()=>h.metadata?JSON.stringify(h.metadata):void 0,[h.metadata]),R=n.useMemo(()=>e.metadata?JSON.stringify(e.metadata):void 0,[e.metadata]);n.useEffect(()=>{if(!(!f||!i.current)){if(D.current!==W&&E!==W){const g={...e};e.global&&(g.global={...e.global}),u(g),D.current=W,i.current.isAutoSaveEnabled()?i.current.debouncedSave(g):i.current.save(g);return}e.metadata&&w!==R&&u(g=>({...g,metadata:e.metadata}))}},[f,i,e,E,W,w,R]);const I=n.useCallback(g=>{if(i.current)try{i.current.isAutoSaveEnabled()?i.current.debouncedSave(g):i.current.save(g),l?.(g)}catch($){s?.($)}},[l,s]),N=n.useCallback(g=>{const $={...g};g.global&&($.global={...g.global}),u($),I($)},[I]),d=n.useCallback(()=>{if(i.current)try{i.current.clear()}catch(g){s?.(g)}},[s]),y=n.useCallback(()=>i.current?.exists()??!1,[]),S=n.useCallback(()=>i.current?.getStorageKey()??"",[]);return{model:h,updateModel:N,clearStorage:d,hasStoredData:y,getStorageKey:S,isLoaded:f,hasStorage:T}},Be=n.forwardRef(({model:e,factory:t,onModelChange:r,onAction:l,className:s="",style:c={},storage:i,closeIcon:h,closeButtonClassName:u,scrollLeftIcon:f,scrollRightIcon:v},T)=>{const[L,D]=n.useState(e),[E,W]=n.useState(null),{model:w,updateModel:R,isLoaded:I}=Me(e,{key:i?.key,autoSave:i?.autoSave,debounceMs:i?.debounceMs,onLoad:a=>{r?r(a):D(a)}}),N=i?.enabled?w:r?e:L,d=n.useRef(r),y=n.useRef(i),S=n.useRef(R);n.useEffect(()=>{d.current=r},[r]),n.useEffect(()=>{y.current=i},[i]),n.useEffect(()=>{S.current=R},[R]);const g=n.useCallback(a=>{y.current?.enabled?(S.current(a),d.current&&d.current(a)):d.current?d.current(a):D(a)},[]),{handleResize:$,resetResize:z}=Ue(N,g),{dragOverTabset:A,dropPosition:ne,dropTargetIndex:P,handleDragStart:ee,handleDragEnd:K,handleDragOver:ue,handleDragLeave:Y,handleDrop:he}=Ye(N,g),de=n.useRef(w);n.useEffect(()=>{de.current=w},[w]);const se=n.useRef(L);n.useEffect(()=>{se.current=L},[L]);const M=n.useRef(e);n.useEffect(()=>{M.current=e},[e]);const B=n.useRef(l);n.useEffect(()=>{B.current=l},[l]);const j=n.useCallback(a=>{if(y.current?.enabled){const p=de.current;if(a.type==="changeDirection"){const{direction:b}=a.payload;W(b)}const _=(b=>{switch(a.type){case"selectTab":const{nodeId:ce,tabIndex:re}=a.payload,Z=J(b.layout,ce,{selected:re});return!Z||Z===b.layout?b:{...b,layout:Z};case"removeNode":const{nodeId:le,tabIndex:G}=a.payload,H=te(b.layout,le);if(H&&H.children){const O=H.children.filter((ge,we)=>we!==G),ie=H.selected??0;let U=ie;G<=ie&&(U=Math.max(0,ie-1)),U=Math.min(U,O.length-1);const De={...H,children:O,selected:O.length>0?U:void 0},me=J(b.layout,le,De);if(me){const ge=fe(me);if(ge)return{...b,layout:ge}}}return b;case"closeTabset":const{nodeId:Q}=a.payload,q=J(b.layout,Q,null);if(q){const O=fe(q);if(O)return{...b,layout:O}}return b;case"changeDirection":const{direction:oe}=a.payload;return{...b,global:{...b.global,direction:oe}};default:return b}})(p);S.current(_),d.current&&d.current(_),B.current?.(a)}else{if(a.type==="changeDirection"&&d.current){const{direction:p}=a.payload,V=M.current,_={...V,global:{...V.global,direction:p}};d.current(_)}B.current?.(a)}if(!y.current?.enabled&&!d.current){const p=se.current,_=(b=>{switch(a.type){case"selectTab":const{nodeId:ce,tabIndex:re}=a.payload,Z=J(b.layout,ce,{selected:re});return!Z||Z===b.layout?b:{...b,layout:Z};case"removeNode":const{nodeId:le,tabIndex:G}=a.payload,H=te(b.layout,le);if(H&&H.children){const O=H.children.filter((ge,we)=>we!==G),ie=H.selected??0;let U=ie;G<=ie&&(U=Math.max(0,ie-1)),U=Math.min(U,O.length-1);const De={...H,children:O,selected:O.length>0?U:void 0},me=J(b.layout,le,De);if(me){const ge=fe(me);if(ge)return{...b,layout:ge}}}return b;case"closeTabset":const{nodeId:Q}=a.payload,q=J(b.layout,Q,null);if(q){const O=fe(q);if(O)return{...b,layout:O}}return b;case"changeDirection":const{direction:oe}=a.payload;return{...b,global:{...b.global,direction:oe}};default:return b}})(p);D(_)}},[]);n.useImperativeHandle(T,()=>({handleAction:j}),[j]);const k=n.useCallback((a,p)=>{j({type:"selectTab",payload:{nodeId:a,tabIndex:p}})},[j]),X=n.useCallback((a,p)=>{j({type:"removeNode",payload:{nodeId:a,tabIndex:p}})},[j]);let ae;i?.enabled?E!==null?ae=E:ae=w?.global?.direction||"ltr":ae=N.global?.direction||"ltr";const be=N.global?.splitterSize||8,o=n.useCallback(a=>{switch(a.type){case"tabset":return m.jsx(Se,{node:a,factory:t,onTabSelect:k,onTabClose:X,onTabDragStart:ee,onTabDragEnd:K,onDragOver:ue,onDragLeave:Y,onDrop:he,dragOverTabset:A,dropPosition:A===a.id?ne:void 0,dropTargetIndex:A===a.id?P:void 0,direction:ae,closeIcon:h,closeButtonClassName:u,scrollLeftIcon:f,scrollRightIcon:v},a.id);case"row":const p=ae==="rtl",V=a.children||[],_=p?[...V].reverse():V;return m.jsx("div",{className:"react-flex-layout-row",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:_.map((b,ce)=>{const re=ce+1;if(!(re<_.length))return m.jsx(n.Fragment,{children:o(b)},b.id);const le=p?V.length-1-ce:ce,G=p?V.length-1-re:re,H=Math.min(le,G);if(Math.max(le,G)!==H+1)return m.jsx(n.Fragment,{children:o(b)},b.id);const q=V[H],oe=p&&le>G;return m.jsxs(n.Fragment,{children:[o(b),m.jsx(ve,{direction:"horizontal",onResize:O=>{const ie=oe?-O:O;$(q.id,ie,"horizontal")},onResizeStart:()=>{z(q.id,"horizontal")},size:be})]},b.id)})},a.id);case"column":return m.jsx("div",{className:"react-flex-layout-column",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:a.children?.map((b,ce)=>m.jsxs(n.Fragment,{children:[o(b),ce<(a.children?.length||0)-1&&m.jsx(ve,{direction:"vertical",onResize:re=>$(b.id,re,"vertical"),onResizeStart:()=>{z(b.id,"vertical")},size:be})]},b.id))},a.id);case"tab":return t(a);default:return null}},[ae,be,t,k,X,$,ee,K,ue,Y,he,A,ne,h,u]);n.useEffect(()=>{!i?.enabled&&E!==null&&W(null)},[i?.enabled,E]),n.useEffect(()=>{i?.enabled&&E!==null&&(w?.global?.direction||"ltr")===E&&W(null)},[i?.enabled,E,w?.global?.direction]);const x=n.useMemo(()=>o(N.layout),[o,N.layout]),F={...c,height:"100%",width:"100%"};return i?.enabled&&!I?m.jsx("div",{className:`react-flex-layout ${s}`,style:{...F,display:"flex",alignItems:"center",justifyContent:"center"},children:m.jsx("div",{children:"Loading layout..."})}):m.jsx("div",{className:`react-flex-layout ${s}`,style:F,dir:ae,children:x})});Be.displayName="Layout";const Fe=n.memo(ye,(e,t)=>!(e.className!==t.className||e.style!==t.style||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.index!==t.index||e.onSelect!==t.onSelect||e.onClose!==t.onClose||e.onDragStart!==t.onDragStart||e.onDragEnd!==t.onDragEnd||e.node.id!==t.node.id||e.node.name!==t.node.name));Fe.displayName="MemoizedTab",C.DefaultCloseIcon=Ie,C.Layout=Be,C.LayoutStorage=Le,C.MemoizedTab=Fe,C.MemoizedTabSet=Se,C.Splitter=ve,C.Tab=ye,C.TabSet=ke,C.addTabToTabset=Oe,C.calculateFlexValues=Ce,C.createColumn=$e,C.createLayoutModel=_e,C.createLayoutStorage=Ge,C.createRow=Ne,C.createTab=Ee,C.createTabSet=Te,C.findNodeById=te,C.isLocalStorageAvailable=Ae,C.removeEmptyTabsets=fe,C.removeNodeById=xe,C.removeTab=qe,C.restoreTab=Je,C.tabExists=Xe,C.updateNodeById=J,C.useLayoutStorage=Me,Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})}));
