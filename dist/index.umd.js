(function(v,b){typeof exports=="object"&&typeof module<"u"?b(exports,require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react"],b):(v=typeof globalThis<"u"?globalThis:v||self,b(v.ReactFlexLayout={},v.React,v.React))})(this,(function(v,b,n){"use strict";const We=({size:e=16,color:t="#666",className:r=""})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[b.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),b.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Ce=({node:e,index:t,onClose:r,onSelect:l,onDragStart:i,onDragEnd:o,className:s="",style:u={},closeIcon:h,closeButtonClassName:S=""})=>{const y=n.useRef(!1),g=n.useCallback(()=>{l?.(e.id)},[e.id,l]),C=n.useCallback(L=>{L.stopPropagation(),r?.(e.id)},[e.id,r]),x=n.useCallback(L=>{L.dataTransfer.setData("text/plain",e.id),L.dataTransfer.effectAllowed="move",L.currentTarget.classList.add("dragging"),document.body.classList.add("dragging"),y.current=!0,i?.(e.id,t)},[e.id,t,i]),E=n.useCallback(L=>{L.currentTarget.classList.remove("dragging"),document.body.classList.remove("dragging"),y.current=!1,o?.()},[o]);n.useEffect(()=>()=>{y.current&&(document.body.classList.remove("dragging"),y.current=!1)},[]);const W=n.useMemo(()=>({...u,cursor:"grab"}),[u]);return b.jsxs("div",{className:`react-flex-layout-tab ${s}`,style:W,onClick:g,draggable:!0,onDragStart:x,onDragEnd:E,children:[b.jsx("span",{className:"react-flex-layout-tab-title",children:e.name||"Untitled"}),b.jsx("button",{className:`react-flex-layout-tab-close ${S}`.trim(),onClick:C,type:"button","aria-label":"Close tab",children:h||b.jsx(We,{})})]})},xe=e=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:b.jsx("polyline",{points:"15 18 9 12 15 6"})});xe.displayName="ScrollLeftIcon";const Le=e=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:b.jsx("polyline",{points:"9 18 15 12 9 6"})});Le.displayName="ScrollRightIcon";const Oe=({node:e,children:t,factory:r,onTabSelect:l,onTabClose:i,onTabDragStart:o,onTabDragEnd:s,onDragOver:u,onDragLeave:h,onDrop:S,dragOverTabset:y,dropPosition:g,dropTargetIndex:C,direction:x="ltr",className:E="",style:W={},closeIcon:L,closeButtonClassName:H,scrollLeftIcon:N,scrollRightIcon:O})=>{const D=n.useMemo(()=>e.children?.filter(c=>c.type==="tab")||[],[e.children]),k=n.useMemo(()=>{const c=new Map;for(let d=0;d<D.length;d++){const K=D[d];K&&K.id&&c.set(K.id,d)}return c},[D]),_=n.useMemo(()=>x==="rtl"?[...D].reverse():D,[D,x]),T=e.selected??0,m=Math.min(T,Math.max(0,D.length-1)),w=D[m],X=n.useCallback(c=>{const d=k.get(c);d!==void 0&&d!==-1&&l?.(e.id,d)},[e.id,k,l]),I=n.useCallback(c=>{const d=k.get(c);d!==void 0&&d!==-1&&i?.(e.id,d)},[e.id,k,i]),R=n.useCallback((c,d)=>{const K=d!==void 0?d:k.get(c)??-1;K!==-1&&o?.(e.id,K)},[e.id,k,o]),B=n.useRef(null),J=n.useRef(null),[U,G]=n.useState(!1),[P,Z]=n.useState(!1),se=n.useRef(null),Y=n.useRef();Y.current=()=>{const c=J.current;if(!c){G(!1),Z(!1);return}const{scrollLeft:d,scrollWidth:K,clientWidth:re}=c;G(d>1),Z(d<K-re-1)};const ue=n.useCallback(()=>{se.current&&clearTimeout(se.current),se.current=setTimeout(()=>{Y.current?.()},10)},[]),ge=n.useCallback(c=>{c.preventDefault(),c.dataTransfer.dropEffect="move";const d=c.currentTarget.getBoundingClientRect(),K=c.clientX-d.left,re=c.clientY-d.top,te=d.width,ae=d.height;let Q="center";if(re<40){const a=B.current;if(a){const M=a.getBoundingClientRect(),A=c.clientX-M.left,z=a.querySelectorAll(".react-flex-layout-tab");let f=D.length;if(x==="rtl"){for(let $=z.length-1;$>=0;$--){const le=z[$].getBoundingClientRect(),ce=le.left-M.left,oe=le.right-M.left,de=(ce+oe)/2;if(A>de){const q=k.get(_[$].id);q!==void 0&&q!==-1&&(f=q);break}}if(f===D.length&&z.length>0){const $=z[0].getBoundingClientRect();if(A>$.right-M.left){const le=k.get(_[0].id);le!==void 0&&le!==-1&&(f=le)}}}else for(let $=0;$<z.length;$++){const le=z[$].getBoundingClientRect(),ce=le.left-M.left,oe=le.right-M.left,de=(ce+oe)/2;if(A<de){const q=k.get(_[$].id);q!==void 0&&q!==-1&&(f=q);break}}Q="tab",u?.(c,e.id,Q,f);return}}K<te*.25?Q=x==="rtl"?"right":"left":K>te*.75?Q=x==="rtl"?"left":"right":re<ae*.25?Q="top":re>ae*.75?Q="bottom":Q="center",u?.(c,e.id,Q)},[e.id,x,D.length,_,k,u]),be=n.useCallback(c=>{h?.(c)},[h]),j=n.useCallback(c=>{S?.(c,e.id)},[e.id,S]),F=y===e.id;n.useEffect(()=>{const c=J.current;if(!c||m<0)return;let d;return d=requestAnimationFrame(()=>{const re=c.children[m];if(!re)return;const te=c.getBoundingClientRect(),ae=re.getBoundingClientRect(),Q=c.scrollLeft;ae.left<te.left?c.scrollTo({left:Q-(te.left-ae.left)-10,behavior:"smooth"}):ae.right>te.right&&c.scrollTo({left:Q+(ae.right-te.right)+10,behavior:"smooth"})}),()=>{d&&cancelAnimationFrame(d)}},[m,_.length]),n.useEffect(()=>{const c=J.current;if(!c)return;const d={current:0};d.current=requestAnimationFrame(()=>{Y.current?.()}),c.addEventListener("scroll",ue,{passive:!0});const K=new ResizeObserver(()=>{d.current&&cancelAnimationFrame(d.current),d.current=requestAnimationFrame(()=>{Y.current?.()})});return K.observe(c),()=>{d.current&&cancelAnimationFrame(d.current),c.removeEventListener("scroll",ue),K.disconnect(),se.current&&(clearTimeout(se.current),se.current=null)}},[ue,_.length]);const ee={...W,width:e.width?`${e.width}%`:void 0,height:e.height?`${e.height}%`:void 0,flex:`${e.flex||1} 1 0%`,minWidth:e.minWidth?`${e.minWidth}px`:void 0,minHeight:e.minHeight?`${e.minHeight}px`:void 0,maxWidth:e.maxWidth?`${e.maxWidth}px`:void 0,maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0};if(D.length===0)return null;const p=F&&g?x==="rtl"&&(g==="left"||g==="right")?g==="left"?"right":"left":g:void 0;return b.jsxs("div",{className:`react-flex-layout-tabset ${F?"drag-over":""} ${E}`,style:ee,"data-tabset-id":e.id,"data-drop-position":p,onDragOver:ge,onDragLeave:be,onDrop:j,children:[b.jsxs("div",{className:"react-flex-layout-tabset-header",ref:B,children:[U&&b.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-left",onClick:()=>{const c=J.current;c&&c.scrollBy({left:-200,behavior:"smooth"})},type:"button","aria-label":"Scroll left",children:N||b.jsx(xe,{})}),b.jsxs("div",{ref:J,className:"react-flex-layout-tabset-tabs-container",onScroll:ue,children:[_.map(c=>{const d=k.get(c.id)??-1,K=d===m,re=F&&g==="tab"&&C!==null&&d===C;return b.jsxs(n.Fragment,{children:[re&&b.jsx("div",{className:"react-flex-layout-tab-drop-indicator"}),b.jsx(Ce,{node:c,index:d,onSelect:X,onClose:I,onDragStart:R,onDragEnd:s,className:K?"active":"",closeIcon:L,closeButtonClassName:H})]},c.id)}),F&&g==="tab"&&C!==null&&C===D.length&&b.jsx("div",{className:"react-flex-layout-tab-drop-indicator"})]}),P&&b.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-right",onClick:()=>{const c=J.current;c&&c.scrollBy({left:200,behavior:"smooth"})},type:"button","aria-label":"Scroll right",children:O||b.jsx(Le,{})})]}),b.jsx("div",{className:"react-flex-layout-tabset-content",children:w&&(r?r(w):t)})]})},we=n.memo(Oe,(e,t)=>{if(e.className!==t.className||e.direction!==t.direction||e.dragOverTabset!==t.dragOverTabset||e.dropPosition!==t.dropPosition||e.dropTargetIndex!==t.dropTargetIndex||e.factory!==t.factory||e.onTabSelect!==t.onTabSelect||e.onTabClose!==t.onTabClose||e.onTabDragStart!==t.onTabDragStart||e.onTabDragEnd!==t.onTabDragEnd||e.onDragOver!==t.onDragOver||e.onDragLeave!==t.onDragLeave||e.onDrop!==t.onDrop||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.style!==t.style||e.children!==t.children)return!1;if(e.node===t.node){if(e.node.selected!==t.node.selected)return!1}else{if(e.node.id!==t.node.id||e.node.selected!==t.node.selected||e.node.width!==t.node.width||e.node.height!==t.node.height||e.node.flex!==t.node.flex||e.node.minWidth!==t.node.minWidth||e.node.minHeight!==t.node.minHeight||e.node.maxWidth!==t.node.maxWidth||e.node.maxHeight!==t.node.maxHeight)return!1;const r=e.node.children||[],l=t.node.children||[];if(r!==l){if(r.length!==l.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!==l[i]){const o=r[i],s=l[i];if(o.id!==s.id||o.type!==s.type||o.name!==s.name||o.component!==s.component||o.enableClose!==s.enableClose||o.enableDrag!==s.enableDrag)return!1}}}return!0});we.displayName="MemoizedTabSet";const Qe=({direction:e,onResize:t,onResizeStart:r,size:l=8,className:i="",style:o={},customStyles:s={}})=>{const[u,h]=n.useState(!1),S=n.useRef(0),y=n.useRef(0),g=n.useRef(!1),C=n.useRef(null),x=n.useRef(null),E=n.useCallback(N=>{N.preventDefault(),N.stopPropagation(),h(!0),S.current=e==="horizontal"?N.clientX:N.clientY,y.current=S.current,r?.();const O=k=>{y.current=e==="horizontal"?k.clientX:k.clientY,g.current||(g.current=!0,requestAnimationFrame(()=>{g.current=!1;const _=y.current-S.current;t(_)}))},D=()=>{h(!1),document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",D),C.current=null,x.current=null,g.current=!1};document.addEventListener("mousemove",O),document.addEventListener("mouseup",D),C.current=O,x.current=D},[e,t,r]),W={backgroundColor:"#ffffff",border:"none",outline:"none"},L=n.useMemo(()=>u&&s.active?s.active:s.default?s.default:W,[u,s.active,s.default]),H=n.useMemo(()=>{const N=e==="horizontal";return{...o,width:N?`${l}px`:"100%",height:N?"100%":`${l}px`,minWidth:N?`${l}px`:void 0,minHeight:N?void 0:`${l}px`,flexShrink:0,cursor:N?"col-resize":"row-resize",...L,transition:u?"none":"all 0.2s ease"}},[e,l,o,L,u]);return n.useEffect(()=>()=>{C.current&&document.removeEventListener("mousemove",C.current),x.current&&document.removeEventListener("mouseup",x.current),g.current=!1},[]),b.jsx("div",{className:`react-flex-layout-splitter ${i}`,style:H,onMouseDown:E})},De=n.memo(Qe,(e,t)=>e.direction===t.direction&&e.size===t.size&&e.onResize===t.onResize&&e.onResizeStart===t.onResizeStart&&e.className===t.className&&e.style===t.style&&e.customStyles===t.customStyles),Re=e=>{const t=new Map,r=new Map,l=(i,o=null)=>{if(t.set(i.id,i),o&&r.set(i.id,o),i.children)for(const s of i.children)l(s,i)};return l(e),{nodeIndex:t,parentIndex:r}},Se=(e,t)=>e.get(t)??null,pe=(e,t)=>e.get(t)??null,Pe=(e,t)=>({global:{enableClose:!0,enableDrag:!0,enableResize:!0,splitterSize:8,tabOverlapLength:0,direction:"ltr",...t},layout:e}),Be=(e,t,r,l)=>({id:e,type:"tab",component:t,name:r,config:l,enableClose:!0,enableDrag:!0}),Ie=(e,t,r=0)=>({id:e,type:"tabset",children:t,selected:r,enableClose:!0,enableDrag:!0}),Fe=(e,t,r,l)=>({id:e,type:"row",children:Ne(t),width:r,height:l,enableResize:!0}),Ke=(e,t,r,l)=>({id:e,type:"column",children:Ne(t),width:r,height:l,enableResize:!0}),ne=(e,t)=>{if(e.id===t)return e;if(e.children)for(const r of e.children){const l=ne(r,t);if(l)return l}return null},_e=(e,t)=>{if(!e.children)return null;for(const r of e.children)if(r.id===t)return e;for(const r of e.children){const l=_e(r,t);if(l)return l}return null},V=(e,t,r)=>{if(e.id===t)return r===null?null:Object.keys(r).some(i=>{const o=i;return e[o]!==r[o]})?{...e,...r}:e;if(e.children){let l=null;const i=e.children;for(let o=0;o<i.length;o++){const s=i[o],u=V(s,t,r);u!==s&&l===null&&(l=i.slice(0,o)),l!==null&&u!==null&&l.push(u)}return l===null?e:{...e,children:l}}return e},Ee=(e,t)=>{if(!e.children)return e;let r=null;const l=e.children;for(let i=0;i<l.length;i++){const o=l[i];if(o.id===t){r===null&&(r=l.slice(0,i));continue}const s=Ee(o,t);s!==o&&r===null&&(r=l.slice(0,i)),r!==null&&r.push(s)}return r===null?e:{...e,children:r}},Ne=e=>e.map(t=>({...t,flex:t.flex||1/e.length})),he=e=>{if(e.type==="tabset"&&(!e.children||e.children.length===0))return null;if(e.children){const t=e.children,r=t.length;let l=null;for(let s=0;s<t.length;s++){const u=t[s],h=he(u);h!==u&&l===null&&(l=t.slice(0,s)),l!==null&&h!==null&&l.push(h)}const i=l??t,o=i.length<r;if(i.length===0)return null;if((e.type==="row"||e.type==="column")&&i.length>0){const s=i.reduce((h,S)=>h+(S.flex||0),0);if(o||s<.999||i.length===1){let h;if(i.length===1)h=i.map(S=>({...S,flex:1}));else if(s===0||s<.001){const S=1/i.length;h=i.map(y=>({...y,flex:S}))}else{const S=1/s;h=i.map(y=>({...y,flex:(y.flex||0)*S}))}return{...e,children:h}}if(i.length!==r||i.some((h,S)=>h!==t[S]))return{...e,children:i}}if(l!==null)return{...e,children:i}}return e},je=(e,t,r=null)=>{if(!e.children)return null;for(const l of e.children){if(l.id===t)return r||e;if(l.children){const i=je(l,t,e);if(i)return i}}return null},qe=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.type==="tabset"&&r.children&&r.children.find(i=>i.id===t))return r;if(r.children){const l=qe(r,t);if(l)return l}}return null},Xe=(e,t,r)=>{const l=ne(e,t);if(!l||l.type!=="tabset")return null;const o=[...l.children||[],r],s={...l,children:o,selected:o.length-1};return V(e,t,s)},et=(e,t)=>{const r=qe(e,t);if(!r||r.type!=="tabset")return{layout:e,restoreData:null};const l=r.children?.find(g=>g.id===t);if(!l||l.type!=="tab")return{layout:e,restoreData:null};const i=r.children?.findIndex(g=>g.id===t),o=r.children?.filter(g=>g.id!==t);if(!o||o.length===0){const g=Ee(e,r.id),C={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:i!==void 0?i:0,config:l.config};return{layout:g,restoreData:C}}const s=r.selected??0;let u=s;i!==void 0&&i!==-1&&(i<=s&&(u=Math.max(0,s-1)),u=Math.min(u,o.length-1));const h={...r,children:o,selected:o.length>0?u:void 0},S=V(e,r.id,h),y={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:i!==void 0?i:0,config:l.config};return{layout:S,restoreData:y}},tt=(e,t,r)=>{if(ne(e,t.tabId))return e;let i=ne(e,t.tabsetId);if(!i||i.type!=="tabset"){if(!r)return null;const u=je(r,t.tabsetId);if(!u)return null;const h=ne(e,u.id);if(!h||!h.children)return null;const S=h.children.find(y=>y.id===t.tabsetId);if(S)i=S;else{const y=Ie(t.tabsetId,[]),g=[...h.children,y],C={...h,children:g},x=V(e,h.id,C);if(!x||(e=x,i=ne(e,t.tabsetId),!i||i.type!=="tabset"))return null}}const o=Be(t.tabId,t.component,t.name,t.config);return Xe(e,t.tabsetId,o)},nt=(e,t)=>ne(e,t)!==null,rt=(e,t,r)=>{const l=n.useRef({}),i=n.useRef({}),o=n.useRef(e),s=n.useRef(t);n.useEffect(()=>{o.current=e},[e]),n.useEffect(()=>{s.current=t},[t]);const u=n.useRef(r);n.useEffect(()=>{u.current=r},[r]);const h=n.useCallback((y,g,C)=>{if(!s.current)return;const x=o.current,E=(u.current&&pe(u.current,y))??Je(x.layout,y);if(!E||!E.children)return;const W=E.children.findIndex(I=>I.id===y),L=W+1;if(L>=E.children.length)return;const H=`${y}-${C}`;if(!l.current[H]){const I=E.children[W],R=E.children[L];l.current[H]={current:I.flex||1,sibling:R.flex||1}}const N=l.current[H],O=N.current+N.sibling,D=C==="horizontal"?window.innerWidth:window.innerHeight,k=N.current/O*D,_=N.sibling/O*D,T=100;let m=k+g,w=_-g;if(m<T){const I=T-m;m=T,w-=I}if(w<T){const I=T-w;w=T,m-=I}const X=m+w;if(X>0){const I=m/X*O,R=w/X*O,B=i.current[H],J=1e-4;if(B&&Math.abs(B.current-I)<J&&Math.abs(B.sibling-R)<J)return;const U=E.children.slice(),G=U[W],P=U[L];U[W]={...G,flex:I},U[L]={...P,flex:R};const Z=V(x.layout,E.id,{children:U});Z&&(i.current[H]={current:I,sibling:R},s.current({...x,layout:Z}))}},[]),S=n.useCallback((y,g)=>{const C=`${y}-${g}`;delete l.current[C],delete i.current[C]},[]);return{handleResize:h,resetResize:S}},Je=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.id===t)return e;const l=Je(r,t);if(l)return l}return null},lt=(e,t,r,l)=>{const[i,o]=n.useState(null),[s,u]=n.useState(null),[h,S]=n.useState("center"),[y,g]=n.useState(null),C=n.useRef(null),x=n.useRef(e),E=n.useRef(t),W=n.useRef(h),L=n.useRef(y),H=n.useRef(r),N=n.useRef(l);n.useEffect(()=>{x.current=e},[e]),n.useEffect(()=>{E.current=t},[t]),n.useEffect(()=>{W.current=h},[h]),n.useEffect(()=>{L.current=y},[y]),n.useEffect(()=>{H.current=r},[r]),n.useEffect(()=>{N.current=l},[l]);const O=n.useCallback((m,w)=>{const X={tabsetId:m,tabIndex:w};o(X),C.current=X},[]),D=n.useCallback(()=>{o(null),C.current=null,u(null),g(null)},[]),k=n.useCallback((m,w,X="center",I)=>{m.preventDefault(),m.dataTransfer.dropEffect="move",u(w),S(X),I!==void 0?g(I):X!=="tab"&&g(null)},[]),_=n.useCallback(m=>{m.currentTarget===m.target&&setTimeout(()=>{u(null),g(null)},50)},[]),T=n.useCallback((m,w)=>{m.preventDefault();const X=C.current,I=x.current,R=E.current,B=W.current,J=L.current;if(!X||!R)return;const{tabsetId:U,tabIndex:G}=X;if(U===w&&B==="tab"&&J!==null){const j=(H.current&&Se(H.current,U))??ne(I.layout,U);if(!j||!j.children)return;const F=j.children[G];if(!F||G===J)return;const ee=[...j.children];ee.splice(G,1),ee.splice(J,0,F);let p=j.selected??0;G<p&&J>=p?p=Math.max(0,p-1):G>p&&J<=p?p=Math.min(p+1,ee.length-1):G===p&&(p=J);const c=V(I.layout,U,{children:ee,selected:p});c&&R({...I,layout:c,metadata:I.metadata}),o(null),u(null),g(null);return}if(U===w&&B!=="tab")return;const P=(H.current&&Se(H.current,U))??ne(I.layout,U),Z=(H.current&&Se(H.current,w))??ne(I.layout,w);if(!P||!Z||!P.children||!Z.children)return;const se=P.children[G];if(!se)return;let Y=I.layout;const ue=P.children.filter((j,F)=>F!==G),ge=V(Y,U,{children:ue,selected:Math.min(P.selected||0,ue.length-1)});if(!ge)return;if(Y=ge,B==="center"){const j=V(Y,w,{children:[...Z.children||[],se],selected:Z.children?.length||0});if(!j)return;Y=j}else{const j=Ie(`${w}-split-${Date.now()}`,[se]),F=(N.current&&pe(N.current,w))??_e(Y,w);if(F){const ee=F.children?.findIndex(p=>p.id===w)||0;if(B==="left"||B==="right"){const p=Fe(`${w}-row-${Date.now()}`,[B==="left"?j:Z,B==="left"?Z:j]),c=V(Y,F.id,{children:[...F.children?.slice(0,ee)||[],p,...F.children?.slice(ee+1)||[]]});if(!c)return;Y=c}else if(B==="top"||B==="bottom"){const p=Ke(`${w}-column-${Date.now()}`,[B==="top"?j:Z,B==="top"?Z:j]),c=V(Y,F.id,{children:[...F.children?.slice(0,ee)||[],p,...F.children?.slice(ee+1)||[]]});if(!c)return;Y=c}}}const be=he(Y);be&&R({...I,layout:be,metadata:I.metadata}),o(null),u(null)},[]);return{draggedTab:i,dragOverTabset:s,dropPosition:h,dropTargetIndex:y,handleDragStart:O,handleDragEnd:D,handleDragOver:k,handleDragLeave:_,handleDrop:T}},it="react-flex-layout";class ke{storageKey;autoSave;debounceMs;saveTimeout=null;lastSavedString=null;isAvailable;constructor(t={}){this.storageKey=`${it}-${t.key||"default"}`,this.autoSave=t.autoSave!==!1,this.debounceMs=t.debounceMs||500,this.isAvailable=Ue()}save(t){if(this.isAvailable)try{const r=JSON.stringify(t);if(r===this.lastSavedString)return;localStorage.setItem(this.storageKey,r),this.lastSavedString=r}catch{}}load(){if(!this.isAvailable)return null;try{const t=localStorage.getItem(this.storageKey);if(t)return this.lastSavedString=t,JSON.parse(t)}catch{}return null}clear(){if(this.isAvailable)try{localStorage.removeItem(this.storageKey),this.lastSavedString=null}catch{}}exists(){return this.isAvailable?localStorage.getItem(this.storageKey)!==null:!1}debouncedSave(t){this.autoSave&&this.isAvailable&&(this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.save(t)},this.debounceMs))}getStorageKey(){return this.storageKey}isAutoSaveEnabled(){return this.autoSave}cancel(){this.saveTimeout&&(clearTimeout(this.saveTimeout),this.saveTimeout=null)}}const st=e=>new ke(e),Ue=()=>{try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}},Ye=(e,t={})=>{const{onLoad:r,onSave:l,onError:i,...o}=t,s=n.useRef(null),[u,h]=n.useState(e),[S,y]=n.useState(!1),[g,C]=n.useState(!1);n.useEffect(()=>{if(s.current)try{s.current.cancel?.()}catch{}s.current=new ke(o),C(!0)},[o.key,o.autoSave,o.debounceMs]),n.useEffect(()=>{if(!s.current||S)return;const T=s.current.load();T?(h(T),y(!0),r?.(T)):y(!0)},[S,r]);const x=n.useRef(),E=n.useMemo(()=>JSON.stringify(u.layout),[u.layout]),W=n.useMemo(()=>JSON.stringify(e.layout),[e.layout]),L=n.useMemo(()=>u.metadata?JSON.stringify(u.metadata):void 0,[u.metadata]),H=n.useMemo(()=>e.metadata?JSON.stringify(e.metadata):void 0,[e.metadata]);n.useEffect(()=>{if(!(!S||!s.current)){if(x.current!==W&&E!==W){const T={...e};e.global&&(T.global={...e.global}),h(T),x.current=W,s.current.isAutoSaveEnabled()?s.current.debouncedSave(T):s.current.save(T);return}e.metadata&&L!==H&&h(T=>({...T,metadata:e.metadata}))}},[S,s,e,E,W,L,H]);const N=n.useCallback(T=>{if(s.current)try{s.current.isAutoSaveEnabled()?s.current.debouncedSave(T):s.current.save(T),l?.(T)}catch(m){i?.(m)}},[l,i]),O=n.useCallback(T=>{const m={...T};T.global&&(m.global={...T.global}),h(m),N(m)},[N]),D=n.useCallback(()=>{if(s.current)try{s.current.clear()}catch(T){i?.(T)}},[i]),k=n.useCallback(()=>s.current?.exists()??!1,[]),_=n.useCallback(()=>s.current?.getStorageKey()??"",[]);return{model:u,updateModel:O,clearStorage:D,hasStoredData:k,getStorageKey:_,isLoaded:S,hasStorage:g}},at=e=>{const t=n.useRef(null),r=n.useRef(e),l=n.useMemo(()=>{if(t.current===null||r.current!==e||r.current.id!==e.id){const i=Re(e);return t.current=i,r.current=e,i}return t.current},[e]);return n.useEffect(()=>{r.current=e},[e]),l},Ve=n.forwardRef(({model:e,factory:t,onModelChange:r,onAction:l,className:i="",style:o={},storage:s,closeIcon:u,closeButtonClassName:h,scrollLeftIcon:S,scrollRightIcon:y},g)=>{const[C,x]=n.useState(e),[E,W]=n.useState(null),{model:L,updateModel:H,isLoaded:N}=Ye(e,{key:s?.key,autoSave:s?.autoSave,debounceMs:s?.debounceMs,onLoad:a=>{r?r(a):x(a)}}),O=s?.enabled?L:r?e:C,{nodeIndex:D,parentIndex:k}=at(O.layout),_=n.useRef(D),T=n.useRef(k);n.useEffect(()=>{_.current=D,T.current=k},[D,k]);const m=n.useRef(r),w=n.useRef(s),X=n.useRef(H);n.useEffect(()=>{m.current=r},[r]),n.useEffect(()=>{w.current=s},[s]),n.useEffect(()=>{X.current=H},[H]);const I=n.useCallback(a=>{w.current?.enabled?(X.current(a),m.current&&m.current(a)):m.current?m.current(a):x(a)},[]),{handleResize:R,resetResize:B}=rt(O,I,k),J=100,U=n.useRef(new Map),G=n.useCallback((a,M)=>{const A=`${a}-${M}`,z=U.current;if(z.has(A)){const $=z.get(A);return z.delete(A),z.set(A,$),$}const f={onResize:$=>{R(a,$,M)},onResizeStart:()=>{B(a,M)}};if(z.size>=J){const $=z.keys().next().value;$&&z.delete($)}return z.set(A,f),f},[R,B]),{dragOverTabset:P,dropPosition:Z,dropTargetIndex:se,handleDragStart:Y,handleDragEnd:ue,handleDragOver:ge,handleDragLeave:be,handleDrop:j}=lt(O,I,D,k),F=n.useRef(L);n.useEffect(()=>{F.current=L},[L]);const ee=n.useRef(C);n.useEffect(()=>{ee.current=C},[C]);const p=n.useRef(e);n.useEffect(()=>{p.current=e},[e]);const c=n.useRef(l);n.useEffect(()=>{c.current=l},[l]);const d=n.useCallback(a=>{if(w.current?.enabled){const M=F.current;if(a.type==="changeDirection"){const{direction:f}=a.payload;W(f)}const z=(f=>{switch(a.type){case"selectTab":const{nodeId:$,tabIndex:le}=a.payload,ce=V(f.layout,$,{selected:le});return!ce||ce===f.layout?f:{...f,layout:ce};case"removeNode":const{nodeId:oe,tabIndex:de}=a.payload,q=Se(_.current,oe)??ne(f.layout,oe);if(q&&q.children){const ie=q.children.filter((ye,Me)=>Me!==de),me=q.selected??0;let fe=me;de<=me&&(fe=Math.max(0,me-1)),fe=Math.min(fe,ie.length-1);const Ae={...q,children:ie,selected:ie.length>0?fe:void 0},Te=V(f.layout,oe,Ae);if(Te){const ye=he(Te);if(ye)return{...f,layout:ye}}}return f;case"closeTabset":const{nodeId:$e}=a.payload,ve=V(f.layout,$e,null);if(ve){const ie=he(ve);if(ie)return{...f,layout:ie}}return f;case"changeDirection":const{direction:He}=a.payload;return{...f,global:{...f.global,direction:He}};default:return f}})(M);X.current(z),m.current&&m.current(z),c.current?.(a)}else{if(a.type==="changeDirection"&&m.current){const{direction:M}=a.payload,A=p.current,z={...A,global:{...A.global,direction:M}};m.current(z)}c.current?.(a)}if(!w.current?.enabled&&!m.current){const M=ee.current,z=(f=>{switch(a.type){case"selectTab":const{nodeId:$,tabIndex:le}=a.payload,ce=V(f.layout,$,{selected:le});return!ce||ce===f.layout?f:{...f,layout:ce};case"removeNode":const{nodeId:oe,tabIndex:de}=a.payload,q=Se(_.current,oe)??ne(f.layout,oe);if(q&&q.children){const ie=q.children.filter((ye,Me)=>Me!==de),me=q.selected??0;let fe=me;de<=me&&(fe=Math.max(0,me-1)),fe=Math.min(fe,ie.length-1);const Ae={...q,children:ie,selected:ie.length>0?fe:void 0},Te=V(f.layout,oe,Ae);if(Te){const ye=he(Te);if(ye)return{...f,layout:ye}}}return f;case"closeTabset":const{nodeId:$e}=a.payload,ve=V(f.layout,$e,null);if(ve){const ie=he(ve);if(ie)return{...f,layout:ie}}return f;case"changeDirection":const{direction:He}=a.payload;return{...f,global:{...f.global,direction:He}};default:return f}})(M);x(z)}},[]);n.useImperativeHandle(g,()=>({handleAction:d}),[d]);const K=n.useCallback((a,M)=>{d({type:"selectTab",payload:{nodeId:a,tabIndex:M}})},[d]),re=n.useCallback((a,M)=>{d({type:"removeNode",payload:{nodeId:a,tabIndex:M}})},[d]);let te;s?.enabled?E!==null?te=E:te=L?.global?.direction||"ltr":te=O.global?.direction||"ltr";const ae=O.global?.splitterSize||8,Q=n.useCallback(a=>{switch(a.type){case"tabset":return b.jsx(we,{node:a,factory:t,onTabSelect:K,onTabClose:re,onTabDragStart:Y,onTabDragEnd:ue,onDragOver:ge,onDragLeave:be,onDrop:j,dragOverTabset:P,dropPosition:P===a.id?Z:void 0,dropTargetIndex:P===a.id?se:void 0,direction:te,closeIcon:u,closeButtonClassName:h,scrollLeftIcon:S,scrollRightIcon:y},a.id);case"row":const M=a.children||[];return b.jsx("div",{className:"react-flex-layout-row",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:M.map((A,z)=>{if(!(z<M.length-1))return b.jsx(n.Fragment,{children:Q(A)},A.id);const $=G(A.id,"horizontal");return b.jsxs(n.Fragment,{children:[Q(A),b.jsx(De,{direction:"horizontal",onResize:$.onResize,onResizeStart:$.onResizeStart,size:ae})]},A.id)})},a.id);case"column":return b.jsx("div",{className:"react-flex-layout-column",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:a.children?.map((A,z)=>{const f=z<(a.children?.length||0)-1?G(A.id,"vertical"):null;return b.jsxs(n.Fragment,{children:[Q(A),f&&b.jsx(De,{direction:"vertical",onResize:f.onResize,onResizeStart:f.onResizeStart,size:ae})]},A.id)})},a.id);case"tab":return t(a);default:return null}},[te,ae,t,K,re,R,Y,ue,ge,be,j,P,Z,u,h,G]);n.useEffect(()=>{!s?.enabled&&E!==null&&W(null)},[s?.enabled,E]),n.useEffect(()=>{s?.enabled&&E!==null&&(L?.global?.direction||"ltr")===E&&W(null)},[s?.enabled,E,L?.global?.direction]);const Ze=n.useMemo(()=>Q(O.layout),[Q,O.layout]),ze={...o,height:"100%",width:"100%"};return s?.enabled&&!N?b.jsx("div",{className:`react-flex-layout ${i}`,style:{...ze,display:"flex",alignItems:"center",justifyContent:"center"},children:b.jsx("div",{children:"Loading layout..."})}):b.jsx("div",{className:`react-flex-layout ${i}`,style:ze,dir:te,children:Ze})});Ve.displayName="Layout";const Ge=n.memo(Ce,(e,t)=>!(e.className!==t.className||e.style!==t.style||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.index!==t.index||e.onSelect!==t.onSelect||e.onClose!==t.onClose||e.onDragStart!==t.onDragStart||e.onDragEnd!==t.onDragEnd||e.node.id!==t.node.id||e.node.name!==t.node.name));Ge.displayName="MemoizedTab",v.DefaultCloseIcon=We,v.Layout=Ve,v.LayoutStorage=ke,v.MemoizedTab=Ge,v.MemoizedTabSet=we,v.ScrollLeftIcon=xe,v.ScrollRightIcon=Le,v.Splitter=De,v.Tab=Ce,v.TabSet=Oe,v.addTabToTabset=Xe,v.calculateFlexValues=Ne,v.createColumn=Ke,v.createLayoutModel=Pe,v.createLayoutStorage=st,v.createRow=Fe,v.createTab=Be,v.createTabSet=Ie,v.findNodeById=ne,v.isLocalStorageAvailable=Ue,v.removeEmptyTabsets=he,v.removeNodeById=Ee,v.removeTab=et,v.restoreTab=tt,v.tabExists=nt,v.updateNodeById=V,v.useLayoutStorage=Ye,Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})}));
