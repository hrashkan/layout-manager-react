(function(m,g){typeof exports=="object"&&typeof module<"u"?g(exports,require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react"],g):(m=typeof globalThis<"u"?globalThis:m||self,g(m.ReactFlexLayout={},m.React,m.React))})(this,(function(m,g,r){"use strict";const Le=({size:e=16,color:t="#666",className:l=""})=>g.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:l,children:[g.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),g.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),me=({node:e,index:t,onClose:l,onSelect:i,onDragStart:s,onDragEnd:c,className:u="",style:f={},closeIcon:h,closeButtonClassName:x=""})=>{const b=r.useRef(!1),d=r.useCallback(()=>{i?.(e.id)},[e.id,i]),v=r.useCallback(N=>{N.stopPropagation(),l?.(e.id)},[e.id,l]),y=r.useCallback(N=>{N.dataTransfer.setData("text/plain",e.id),N.dataTransfer.effectAllowed="move",N.currentTarget.classList.add("dragging"),document.body.classList.add("dragging"),b.current=!0,s?.(e.id,t)},[e.id,t,s]),k=r.useCallback(N=>{N.currentTarget.classList.remove("dragging"),document.body.classList.remove("dragging"),b.current=!1,c?.()},[c]);r.useEffect(()=>()=>{b.current&&(document.body.classList.remove("dragging"),b.current=!1)},[]);const B=r.useMemo(()=>({...f,cursor:"grab"}),[f]);return g.jsxs("div",{className:`react-flex-layout-tab ${u}`,style:B,onClick:d,draggable:!0,onDragStart:y,onDragEnd:k,children:[g.jsx("span",{className:"react-flex-layout-tab-title",children:e.name||"Untitled"}),g.jsx("button",{className:`react-flex-layout-tab-close ${x}`.trim(),onClick:v,type:"button","aria-label":"Close tab",children:h||g.jsx(Le,{})})]})},ye=e=>g.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:g.jsx("polyline",{points:"15 18 9 12 15 6"})});ye.displayName="ScrollLeftIcon";const Ce=e=>g.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:g.jsx("polyline",{points:"9 18 15 12 9 6"})});Ce.displayName="ScrollRightIcon";const Ie=({node:e,children:t,factory:l,onTabSelect:i,onTabClose:s,onTabDragStart:c,onTabDragEnd:u,onDragOver:f,onDragLeave:h,onDrop:x,dragOverTabset:b,dropPosition:d,dropTargetIndex:v,direction:y="ltr",className:k="",style:B={},closeIcon:N,closeButtonClassName:F,scrollLeftIcon:w,scrollRightIcon:_})=>{const L=r.useMemo(()=>e.children?.filter(n=>n.type==="tab")||[],[e.children]),$=r.useMemo(()=>{const n=new Map;for(let a=0;a<L.length;a++){const o=L[a];o&&o.id&&n.set(o.id,a)}return n},[L]),Y=r.useMemo(()=>L,[L]),P=e.selected??0,D=Math.min(P,Math.max(0,L.length-1)),C=L[D],p=r.useCallback(n=>{const a=$.get(n);a!==void 0&&a!==-1&&i?.(e.id,a)},[e.id,$,i]),S=r.useCallback(n=>{const a=$.get(n);a!==void 0&&a!==-1&&s?.(e.id,a)},[e.id,$,s]),Z=r.useCallback((n,a)=>{const o=a!==void 0?a:$.get(n)??-1;o!==-1&&c?.(e.id,o)},[e.id,$,c]),H=r.useRef(null),A=r.useRef(null),[O,X]=r.useState(!1),[ee,j]=r.useState(!1),G=r.useRef(null),E=r.useRef();E.current=()=>{const n=A.current;if(!n){X(!1),j(!1);return}const{scrollLeft:a,scrollWidth:o,clientWidth:T}=n;X(a>1),j(a<o-T-1)};const ne=r.useCallback(()=>{G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{E.current?.()},10)},[]),se=r.useCallback(n=>{n.preventDefault(),n.dataTransfer.dropEffect="move";const a=n.currentTarget.getBoundingClientRect(),o=n.clientX-a.left,T=n.clientY-a.top,q=a.width,z=a.height;let U="center";if(T<40){const fe=H.current;if(fe){const re=fe.getBoundingClientRect(),he=n.clientX-re.left,Q=fe.querySelectorAll(".react-flex-layout-tab");let le=L.length;if(y==="rtl"){for(let K=Q.length-1;K>=0;K--){const te=Q[K].getBoundingClientRect(),ue=te.left-re.left,ce=te.right-re.left,ge=(ue+ce)/2;if(he>ge){const ae=$.get(Y[K].id);ae!==void 0&&ae!==-1&&(le=ae);break}}if(le===L.length&&Q.length>0){const K=Q[0].getBoundingClientRect();if(he>K.right-re.left){const te=$.get(Y[0].id);te!==void 0&&te!==-1&&(le=te)}}}else for(let K=0;K<Q.length;K++){const te=Q[K].getBoundingClientRect(),ue=te.left-re.left,ce=te.right-re.left,ge=(ue+ce)/2;if(he<ge){const ae=$.get(Y[K].id);ae!==void 0&&ae!==-1&&(le=ae);break}}U="tab",f?.(n,e.id,U,le);return}}o<q*.25?U=y==="rtl"?"right":"left":o>q*.75?U=y==="rtl"?"left":"right":T<z*.25?U="top":T>z*.75?U="bottom":U="center",f?.(n,e.id,U)},[e.id,y,L.length,Y,$,f]),ie=r.useCallback(n=>{h?.(n)},[h]),W=r.useCallback(n=>{x?.(n,e.id)},[e.id,x]),I=b===e.id;r.useEffect(()=>{const n=A.current;if(!n||D<0)return;let a;return a=requestAnimationFrame(()=>{const T=n.children[D];if(!T)return;const q=n.getBoundingClientRect(),z=T.getBoundingClientRect(),U=n.scrollLeft;z.left<q.left?n.scrollTo({left:U-(q.left-z.left)-10,behavior:"smooth"}):z.right>q.right&&n.scrollTo({left:U+(z.right-q.right)+10,behavior:"smooth"})}),()=>{a&&cancelAnimationFrame(a)}},[D,Y.length]),r.useEffect(()=>{const n=A.current;if(!n)return;const a={current:0};a.current=requestAnimationFrame(()=>{E.current?.()}),n.addEventListener("scroll",ne,{passive:!0});const o=new ResizeObserver(()=>{a.current&&cancelAnimationFrame(a.current),a.current=requestAnimationFrame(()=>{E.current?.()})});return o.observe(n),()=>{a.current&&cancelAnimationFrame(a.current),n.removeEventListener("scroll",ne),o.disconnect(),G.current&&(clearTimeout(G.current),G.current=null)}},[ne,Y.length]);const J={...B,width:e.width?`${e.width}%`:void 0,height:e.height?`${e.height}%`:void 0,flex:`${e.flex||1} 1 0%`,minWidth:e.minWidth?`${e.minWidth}px`:void 0,minHeight:e.minHeight?`${e.minHeight}px`:void 0,maxWidth:e.maxWidth?`${e.maxWidth}px`:void 0,maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0};if(L.length===0)return null;const M=I&&d?y==="rtl"&&(d==="left"||d==="right")?d==="left"?"right":"left":d:void 0;return g.jsxs("div",{className:`react-flex-layout-tabset ${I?"drag-over":""} ${k}`,style:J,"data-tabset-id":e.id,"data-drop-position":M,onDragOver:se,onDragLeave:ie,onDrop:W,children:[g.jsxs("div",{className:"react-flex-layout-tabset-header",ref:H,children:[O&&g.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-left",onClick:()=>{const n=A.current;n&&n.scrollBy({left:-200,behavior:"smooth"})},type:"button","aria-label":"Scroll left",children:w||g.jsx(ye,{})}),g.jsxs("div",{ref:A,className:"react-flex-layout-tabset-tabs-container",onScroll:ne,children:[Y.map(n=>{const a=$.get(n.id)??-1,o=a===D,T=I&&d==="tab"&&v!==null&&a===v;return g.jsxs(r.Fragment,{children:[T&&g.jsx("div",{className:"react-flex-layout-tab-drop-indicator"}),g.jsx(me,{node:n,index:a,onSelect:p,onClose:S,onDragStart:Z,onDragEnd:u,className:o?"active":"",closeIcon:N,closeButtonClassName:F})]},n.id)}),I&&d==="tab"&&v!==null&&v===L.length&&g.jsx("div",{className:"react-flex-layout-tab-drop-indicator"})]}),ee&&g.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-right",onClick:()=>{const n=A.current;n&&n.scrollBy({left:200,behavior:"smooth"})},type:"button","aria-label":"Scroll right",children:_||g.jsx(Ce,{})})]}),g.jsx("div",{className:"react-flex-layout-tabset-content",children:C&&(l?l(C):t)})]})},xe=r.memo(Ie,(e,t)=>{if(e.className!==t.className||e.direction!==t.direction||e.dragOverTabset!==t.dragOverTabset||e.dropPosition!==t.dropPosition||e.dropTargetIndex!==t.dropTargetIndex||e.factory!==t.factory||e.onTabSelect!==t.onTabSelect||e.onTabClose!==t.onTabClose||e.onTabDragStart!==t.onTabDragStart||e.onTabDragEnd!==t.onTabDragEnd||e.onDragOver!==t.onDragOver||e.onDragLeave!==t.onDragLeave||e.onDrop!==t.onDrop||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.style!==t.style||e.children!==t.children)return!1;if(e.node===t.node){if(e.node.selected!==t.node.selected)return!1}else{if(e.node.id!==t.node.id||e.node.selected!==t.node.selected||e.node.width!==t.node.width||e.node.height!==t.node.height||e.node.flex!==t.node.flex||e.node.minWidth!==t.node.minWidth||e.node.minHeight!==t.node.minHeight||e.node.maxWidth!==t.node.maxWidth||e.node.maxHeight!==t.node.maxHeight)return!1;const l=e.node.children||[],i=t.node.children||[];if(l!==i){if(l.length!==i.length)return!1;for(let s=0;s<l.length;s++)if(l[s]!==i[s]){const c=l[s],u=i[s];if(c.id!==u.id||c.type!==u.type||c.name!==u.name||c.component!==u.component||c.enableClose!==u.enableClose||c.enableDrag!==u.enableDrag)return!1}}}return!0});xe.displayName="MemoizedTabSet";const Oe=({direction:e,onResize:t,onResizeStart:l,size:i=8,className:s="",style:c={},customStyles:u={}})=>{const[f,h]=r.useState(!1),x=r.useRef(0),b=r.useRef(0),d=r.useRef(!1),v=r.useRef(null),y=r.useRef(null),k=r.useCallback(w=>{w.preventDefault(),w.stopPropagation(),h(!0),x.current=e==="horizontal"?w.clientX:w.clientY,b.current=x.current,l?.();const _=$=>{b.current=e==="horizontal"?$.clientX:$.clientY,d.current||(d.current=!0,requestAnimationFrame(()=>{d.current=!1;const Y=b.current-x.current;t(Y)}))},L=()=>{h(!1),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",L),v.current=null,y.current=null,d.current=!1};document.addEventListener("mousemove",_),document.addEventListener("mouseup",L),v.current=_,y.current=L},[e,t,l]),B={backgroundColor:"#ffffff",border:"none",outline:"none"},N=r.useMemo(()=>f&&u.active?u.active:u.default?u.default:B,[f,u.active,u.default]),F=r.useMemo(()=>{const w=e==="horizontal";return{...c,width:w?`${i}px`:"100%",height:w?"100%":`${i}px`,minWidth:w?`${i}px`:void 0,minHeight:w?void 0:`${i}px`,flexShrink:0,cursor:w?"col-resize":"row-resize",...N,transition:f?"none":"all 0.2s ease"}},[e,i,c,N,f]);return r.useEffect(()=>()=>{v.current&&document.removeEventListener("mousemove",v.current),y.current&&document.removeEventListener("mouseup",y.current),d.current=!1},[]),g.jsx("div",{className:`react-flex-layout-splitter ${s}`,style:F,onMouseDown:k})},Te=r.memo(Oe,(e,t)=>e.direction===t.direction&&e.size===t.size&&e.onResize===t.onResize&&e.onResizeStart===t.onResizeStart&&e.className===t.className&&e.style===t.style&&e.customStyles===t.customStyles),pe=e=>{const t=new Map,l=new Map,i=(s,c=null)=>{if(t.set(s.id,s),c&&l.set(s.id,c),s.children)for(const u of s.children)i(u,s)};return i(e),{nodeIndex:t,parentIndex:l}},be=(e,t)=>e.get(t)??null,Ne=(e,t)=>e.get(t)??null,je=(e,t)=>({global:{enableClose:!0,enableDrag:!0,enableResize:!0,splitterSize:8,tabOverlapLength:0,direction:"ltr",...t},layout:e}),ke=(e,t,l,i)=>({id:e,type:"tab",component:t,name:l,config:i,enableClose:!0,enableDrag:!0}),ve=(e,t,l=0)=>({id:e,type:"tabset",children:t,selected:l,enableClose:!0,enableDrag:!0}),Ee=(e,t,l,i)=>({id:e,type:"row",children:we(t),width:l,height:i,enableResize:!0}),ze=(e,t,l,i)=>({id:e,type:"column",children:we(t),width:l,height:i,enableResize:!0}),R=(e,t)=>{if(e.id===t)return e;if(e.children)for(const l of e.children){const i=R(l,t);if(i)return i}return null},$e=(e,t)=>{if(!e.children)return null;for(const l of e.children)if(l.id===t)return e;for(const l of e.children){const i=$e(l,t);if(i)return i}return null},V=(e,t,l)=>{if(e.id===t)return l===null?null:Object.keys(l).some(s=>{const c=s;return e[c]!==l[c]})?{...e,...l}:e;if(e.children){let i=null;const s=e.children;for(let c=0;c<s.length;c++){const u=s[c],f=V(u,t,l);f!==u&&i===null&&(i=s.slice(0,c)),i!==null&&f!==null&&i.push(f)}return i===null?e:{...e,children:i}}return e},Se=(e,t)=>{if(!e.children)return e;let l=null;const i=e.children;for(let s=0;s<i.length;s++){const c=i[s];if(c.id===t){l===null&&(l=i.slice(0,s));continue}const u=Se(c,t);u!==c&&l===null&&(l=i.slice(0,s)),l!==null&&l.push(u)}return l===null?e:{...e,children:l}},we=e=>e.map(t=>({...t,flex:t.flex||1/e.length})),de=e=>{if(e.type==="tabset"&&(!e.children||e.children.length===0))return null;if(e.children){const t=e.children,l=t.length;let i=null;for(let u=0;u<t.length;u++){const f=t[u],h=de(f);h!==f&&i===null&&(i=t.slice(0,u)),i!==null&&h!==null&&i.push(h)}const s=i??t,c=s.length<l;if(s.length===0)return null;if((e.type==="row"||e.type==="column")&&s.length>0){const u=s.reduce((h,x)=>h+(x.flex||0),0);if(c||u<.999||s.length===1){let h;if(s.length===1)h=s.map(x=>({...x,flex:1}));else if(u===0||u<.001){const x=1/s.length;h=s.map(b=>({...b,flex:x}))}else{const x=1/u;h=s.map(b=>({...b,flex:(b.flex||0)*x}))}return{...e,children:h}}if(s.length!==l||s.some((h,x)=>h!==t[x]))return{...e,children:s}}if(i!==null)return{...e,children:s}}return e},He=(e,t,l=null)=>{if(!e.children)return null;for(const i of e.children){if(i.id===t)return l||e;if(i.children){const s=He(i,t,e);if(s)return s}}return null},Me=(e,t)=>{if(!e.children)return null;for(const l of e.children){if(l.type==="tabset"&&l.children&&l.children.find(s=>s.id===t))return l;if(l.children){const i=Me(l,t);if(i)return i}}return null},We=(e,t,l)=>{const i=R(e,t);if(!i||i.type!=="tabset")return null;const c=[...i.children||[],l],u={...i,children:c,selected:c.length-1};return V(e,t,u)},qe=(e,t)=>{const l=Me(e,t);if(!l||l.type!=="tabset")return{layout:e,restoreData:null};const i=l.children?.find(d=>d.id===t);if(!i||i.type!=="tab")return{layout:e,restoreData:null};const s=l.children?.findIndex(d=>d.id===t),c=l.children?.filter(d=>d.id!==t);if(!c||c.length===0){const d=Se(e,l.id),v={tabId:i.id,component:i.component||"",name:i.name||"",tabsetId:l.id,tabIndex:s!==void 0?s:0,config:i.config};return{layout:d,restoreData:v}}const u=l.selected??0;let f=u;s!==void 0&&s!==-1&&(s<=u&&(f=Math.max(0,u-1)),f=Math.min(f,c.length-1));const h={...l,children:c,selected:c.length>0?f:void 0},x=V(e,l.id,h),b={tabId:i.id,component:i.component||"",name:i.name||"",tabsetId:l.id,tabIndex:s!==void 0?s:0,config:i.config};return{layout:x,restoreData:b}},Xe=(e,t,l)=>{if(R(e,t.tabId))return e;let s=R(e,t.tabsetId);if(!s||s.type!=="tabset"){if(!l)return null;const f=He(l,t.tabsetId);if(!f)return null;const h=R(e,f.id);if(!h||!h.children)return null;const x=h.children.find(b=>b.id===t.tabsetId);if(x)s=x;else{const b=ve(t.tabsetId,[]),d=[...h.children,b],v={...h,children:d},y=V(e,h.id,v);if(!y||(e=y,s=R(e,t.tabsetId),!s||s.type!=="tabset"))return null}}const c=ke(t.tabId,t.component,t.name,t.config);return We(e,t.tabsetId,c)},Ke=(e,t)=>R(e,t)!==null,_e=(e,t,l)=>{const i=r.useRef({}),s=r.useRef({}),c=r.useRef(e),u=r.useRef(t);r.useEffect(()=>{c.current=e},[e]),r.useEffect(()=>{u.current=t},[t]);const f=r.useRef(l);r.useEffect(()=>{f.current=l},[l]);const h=r.useCallback((b,d,v)=>{if(!u.current)return;const y=c.current,k=(f.current&&Ne(f.current,b))??Be(y.layout,b);if(!k||!k.children)return;const B=k.children.findIndex(S=>S.id===b),N=B+1;if(N>=k.children.length)return;const F=`${b}-${v}`;if(!i.current[F]){const S=k.children[B],Z=k.children[N];i.current[F]={current:S.flex||1,sibling:Z.flex||1}}const w=i.current[F],_=w.current+w.sibling,L=v==="horizontal"?window.innerWidth:window.innerHeight,$=w.current/_*L,Y=w.sibling/_*L,P=100;let D=$+d,C=Y-d;if(D<P){const S=P-D;D=P,C-=S}if(C<P){const S=P-C;C=P,D-=S}const p=D+C;if(p>0){const S=D/p*_,Z=C/p*_,H=s.current[F],A=1e-4;if(H&&Math.abs(H.current-S)<A&&Math.abs(H.sibling-Z)<A)return;const O=k.children.slice(),X=O[B],ee=O[N];O[B]={...X,flex:S},O[N]={...ee,flex:Z};const j=V(y.layout,k.id,{children:O});j&&(s.current[F]={current:S,sibling:Z},u.current({...y,layout:j}))}},[]),x=r.useCallback((b,d)=>{const v=`${b}-${d}`;delete i.current[v],delete s.current[v]},[]);return{handleResize:h,resetResize:x}},Be=(e,t)=>{if(!e.children)return null;for(const l of e.children){if(l.id===t)return e;const i=Be(l,t);if(i)return i}return null},Ye=(e,t,l,i)=>{const[s,c]=r.useState(null),[u,f]=r.useState(null),[h,x]=r.useState("center"),[b,d]=r.useState(null),v=r.useRef(null),y=r.useRef(e),k=r.useRef(t),B=r.useRef(h),N=r.useRef(b),F=r.useRef(l),w=r.useRef(i);r.useEffect(()=>{y.current=e},[e]),r.useEffect(()=>{k.current=t},[t]),r.useEffect(()=>{B.current=h},[h]),r.useEffect(()=>{N.current=b},[b]),r.useEffect(()=>{F.current=l},[l]),r.useEffect(()=>{w.current=i},[i]);const _=r.useCallback((D,C)=>{const p={tabsetId:D,tabIndex:C};c(p),v.current=p},[]),L=r.useCallback(()=>{c(null),v.current=null,f(null),d(null)},[]),$=r.useCallback((D,C,p="center",S)=>{D.preventDefault(),D.dataTransfer.dropEffect="move",f(C),x(p),S!==void 0?d(S):p!=="tab"&&d(null)},[]),Y=r.useCallback(D=>{D.currentTarget===D.target&&setTimeout(()=>{f(null),d(null)},50)},[]),P=r.useCallback((D,C)=>{D.preventDefault();const p=v.current,S=y.current,Z=k.current,H=B.current,A=N.current;if(!p||!Z)return;const{tabsetId:O,tabIndex:X}=p;if(O===C&&H==="tab"&&A!==null){const W=(F.current&&be(F.current,O))??R(S.layout,O);if(!W||!W.children)return;const I=W.children[X];if(!I||X===A)return;const J=[...W.children];J.splice(X,1),J.splice(A,0,I);let M=W.selected??0;X<M&&A>=M?M=Math.max(0,M-1):X>M&&A<=M?M=Math.min(M+1,J.length-1):X===M&&(M=A);const n=V(S.layout,O,{children:J,selected:M});n&&Z({...S,layout:n,metadata:S.metadata}),c(null),f(null),d(null);return}if(O===C&&H!=="tab")return;const ee=(F.current&&be(F.current,O))??R(S.layout,O),j=(F.current&&be(F.current,C))??R(S.layout,C);if(!ee||!j||!ee.children||!j.children)return;const G=ee.children[X];if(!G)return;let E=S.layout;const ne=ee.children.filter((W,I)=>I!==X),se=V(E,O,{children:ne,selected:Math.min(ee.selected||0,ne.length-1)});if(!se)return;if(E=se,H==="center"){const W=V(E,C,{children:[...j.children||[],G],selected:j.children?.length||0});if(!W)return;E=W}else{const W=ve(`${C}-split-${Date.now()}`,[G]),I=(w.current&&Ne(w.current,C))??$e(E,C);if(I){const J=I.children?.findIndex(M=>M.id===C)||0;if(H==="left"||H==="right"){const M=Ee(`${C}-row-${Date.now()}`,[H==="left"?W:j,H==="left"?j:W]),n=V(E,I.id,{children:[...I.children?.slice(0,J)||[],M,...I.children?.slice(J+1)||[]]});if(!n)return;E=n}else if(H==="top"||H==="bottom"){const M=ze(`${C}-column-${Date.now()}`,[H==="top"?W:j,H==="top"?j:W]),n=V(E,I.id,{children:[...I.children?.slice(0,J)||[],M,...I.children?.slice(J+1)||[]]});if(!n)return;E=n}}}const ie=de(E);ie&&Z({...S,layout:ie,metadata:S.metadata}),c(null),f(null)},[]);return{draggedTab:s,dragOverTabset:u,dropPosition:h,dropTargetIndex:b,handleDragStart:_,handleDragEnd:L,handleDragOver:$,handleDragLeave:Y,handleDrop:P}},Ue=e=>{const t=r.useRef(null),l=r.useRef(e),i=r.useMemo(()=>{if(t.current===null||l.current!==e||l.current.id!==e.id){const s=pe(e);return t.current=s,l.current=e,s}return t.current},[e]);return r.useEffect(()=>{l.current=e},[e]),i},Fe=r.forwardRef(({model:e,factory:t,onModelChange:l,onAction:i,className:s="",style:c={},closeIcon:u,closeButtonClassName:f,scrollLeftIcon:h,scrollRightIcon:x},b)=>{const[d,v]=r.useState(e),y=l?e:d,{nodeIndex:k,parentIndex:B}=Ue(y.layout),N=r.useRef(k),F=r.useRef(B);r.useEffect(()=>{N.current=k,F.current=B},[k,B]);const w=r.useRef(l);r.useEffect(()=>{w.current=l},[l]);const _=r.useCallback(n=>{w.current?w.current(n):v(n)},[]),{handleResize:L,resetResize:$}=_e(y,_,B),Y=100,P=r.useRef(new Map),D=r.useCallback((n,a)=>{const o=`${n}-${a}`,T=P.current;if(T.has(o)){const z=T.get(o);return T.delete(o),T.set(o,z),z}const q={onResize:z=>{L(n,z,a)},onResizeStart:()=>{$(n,a)}};if(T.size>=Y){const z=T.keys().next().value;z&&T.delete(z)}return T.set(o,q),q},[L,$]),{dragOverTabset:C,dropPosition:p,dropTargetIndex:S,handleDragStart:Z,handleDragEnd:H,handleDragOver:A,handleDragLeave:O,handleDrop:X}=Ye(y,_,k,B),ee=r.useRef(d);r.useEffect(()=>{ee.current=d},[d]);const j=r.useRef(e);r.useEffect(()=>{j.current=e},[e]);const G=r.useRef(i);r.useEffect(()=>{G.current=i},[i]);const E=r.useCallback(n=>{const a=o=>{switch(n.type){case"selectTab":const{nodeId:T,tabIndex:q}=n.payload,z=V(o.layout,T,{selected:q});return!z||z===o.layout?o:{...o,layout:z};case"removeNode":const{nodeId:U,tabIndex:De}=n.payload,oe=be(N.current,U)??R(o.layout,U);if(oe&&oe.children){const Q=oe.children.filter((ce,ge)=>ge!==De),le=oe.selected??0;let K=le;De<=le&&(K=Math.max(0,le-1)),K=Math.min(K,Q.length-1);const te={...oe,children:Q,selected:Q.length>0?K:void 0},ue=V(o.layout,U,te);if(ue){const ce=de(ue);if(ce)return{...o,layout:ce}}}return o;case"closeTabset":const{nodeId:fe}=n.payload,re=V(o.layout,fe,null);if(re){const Q=de(re);if(Q)return{...o,layout:Q}}return o;case"changeDirection":const{direction:he}=n.payload;return{...o,global:{...o.global,direction:he}};default:return o}};if(w.current){const o=j.current,T=a(o);w.current(T)}else{const o=ee.current,T=a(o);v(T)}G.current?.(n)},[]);r.useImperativeHandle(b,()=>({handleAction:E}),[E]);const ne=r.useCallback((n,a)=>{E({type:"selectTab",payload:{nodeId:n,tabIndex:a}})},[E]),se=r.useCallback((n,a)=>{E({type:"removeNode",payload:{nodeId:n,tabIndex:a}})},[E]),ie=y.global?.direction||"ltr",W=y.global?.splitterSize||8,I=r.useCallback(n=>{switch(n.type){case"tabset":return g.jsx(xe,{node:n,factory:t,onTabSelect:ne,onTabClose:se,onTabDragStart:Z,onTabDragEnd:H,onDragOver:A,onDragLeave:O,onDrop:X,dragOverTabset:C,dropPosition:C===n.id?p:void 0,dropTargetIndex:C===n.id?S:void 0,direction:ie,closeIcon:u,closeButtonClassName:f,scrollLeftIcon:h,scrollRightIcon:x},n.id);case"row":const a=n.children||[];return g.jsx("div",{className:"react-flex-layout-row",style:{width:n.width?`${n.width}%`:void 0,height:n.height?`${n.height}%`:void 0,flex:`${n.flex||1} 1 0%`,minWidth:n.minWidth?`${n.minWidth}px`:void 0,minHeight:n.minHeight?`${n.minHeight}px`:void 0,maxWidth:n.maxWidth?`${n.maxWidth}px`:void 0,maxHeight:n.maxHeight?`${n.maxHeight}px`:void 0},children:a.map((o,T)=>{if(!(T<a.length-1))return g.jsx(r.Fragment,{children:I(o)},o.id);const z=D(o.id,"horizontal");return g.jsxs(r.Fragment,{children:[I(o),g.jsx(Te,{direction:"horizontal",onResize:z.onResize,onResizeStart:z.onResizeStart,size:W})]},o.id)})},n.id);case"column":return g.jsx("div",{className:"react-flex-layout-column",style:{width:n.width?`${n.width}%`:void 0,height:n.height?`${n.height}%`:void 0,flex:`${n.flex||1} 1 0%`,minWidth:n.minWidth?`${n.minWidth}px`:void 0,minHeight:n.minHeight?`${n.minHeight}px`:void 0,maxWidth:n.maxWidth?`${n.maxWidth}px`:void 0,maxHeight:n.maxHeight?`${n.maxHeight}px`:void 0},children:n.children?.map((o,T)=>{const q=T<(n.children?.length||0)-1?D(o.id,"vertical"):null;return g.jsxs(r.Fragment,{children:[I(o),q&&g.jsx(Te,{direction:"vertical",onResize:q.onResize,onResizeStart:q.onResizeStart,size:W})]},o.id)})},n.id);case"tab":return t(n);default:return null}},[ie,W,t,ne,se,L,Z,H,A,O,X,C,p,u,f,D]),J=r.useMemo(()=>I(y.layout),[I,y.layout]),M={...c,height:"100%",width:"100%"};return g.jsx("div",{className:`react-flex-layout ${s}`,style:M,dir:ie,children:J})});Fe.displayName="Layout";const Ae=r.memo(me,(e,t)=>!(e.className!==t.className||e.style!==t.style||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.index!==t.index||e.onSelect!==t.onSelect||e.onClose!==t.onClose||e.onDragStart!==t.onDragStart||e.onDragEnd!==t.onDragEnd||e.node.id!==t.node.id||e.node.name!==t.node.name));Ae.displayName="MemoizedTab",m.DefaultCloseIcon=Le,m.Layout=Fe,m.MemoizedTab=Ae,m.MemoizedTabSet=xe,m.ScrollLeftIcon=ye,m.ScrollRightIcon=Ce,m.Splitter=Te,m.Tab=me,m.TabSet=Ie,m.addTabToTabset=We,m.calculateFlexValues=we,m.createColumn=ze,m.createLayoutModel=je,m.createRow=Ee,m.createTab=ke,m.createTabSet=ve,m.findNodeById=R,m.removeEmptyTabsets=de,m.removeNodeById=Se,m.removeTab=qe,m.restoreTab=Xe,m.tabExists=Ke,m.updateNodeById=V,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})}));
