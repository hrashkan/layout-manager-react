(function(x,S){typeof exports=="object"&&typeof module<"u"?S(exports,require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react"],S):(x=typeof globalThis<"u"?globalThis:x||self,S(x.ReactFlexLayout={},x.React,x.React))})(this,(function(x,S,n){"use strict";const Ee=({size:e=16,color:t="#666",className:r=""})=>S.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[S.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),S.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),ve=({node:e,index:t,onClose:r,onSelect:l,onDragStart:s,onDragEnd:c,className:i="",style:y={},closeIcon:u,closeButtonClassName:g=""})=>{const v=n.useRef(!1),T=n.useCallback(()=>{l?.(e.id)},[e.id,l]),C=n.useCallback(w=>{w.stopPropagation(),r?.(e.id)},[e.id,r]),D=n.useCallback(w=>{w.dataTransfer.setData("text/plain",e.id),w.dataTransfer.effectAllowed="move",w.currentTarget.classList.add("dragging"),document.body.classList.add("dragging"),v.current=!0,s?.(e.id,t)},[e.id,t,s]),z=n.useCallback(w=>{w.currentTarget.classList.remove("dragging"),document.body.classList.remove("dragging"),v.current=!1,c?.()},[c]);n.useEffect(()=>()=>{v.current&&(document.body.classList.remove("dragging"),v.current=!1)},[]);const O=n.useMemo(()=>({...y,cursor:"grab"}),[y]);return S.jsxs("div",{className:`react-flex-layout-tab ${i}`,style:O,onClick:T,draggable:!0,onDragStart:D,onDragEnd:z,children:[S.jsx("span",{className:"react-flex-layout-tab-title",children:e.name||"Untitled"}),S.jsx("button",{className:`react-flex-layout-tab-close ${g}`.trim(),onClick:C,type:"button","aria-label":"Close tab",children:u||S.jsx(Ee,{})})]})},_e=()=>S.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:S.jsx("polyline",{points:"15 18 9 12 15 6"})}),qe=()=>S.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:S.jsx("polyline",{points:"9 18 15 12 9 6"})}),Ne=({node:e,children:t,factory:r,onTabSelect:l,onTabClose:s,onTabDragStart:c,onTabDragEnd:i,onDragOver:y,onDragLeave:u,onDrop:g,dragOverTabset:v,dropPosition:T,dropTargetIndex:C,direction:D="ltr",className:z="",style:O={},closeIcon:w,closeButtonClassName:U,scrollLeftIcon:A,scrollRightIcon:j})=>{const b=n.useMemo(()=>e.children?.filter(o=>o.type==="tab")||[],[e.children]),m=n.useMemo(()=>{const o=new Map;for(let h=0;h<b.length;h++){const K=b[h];K&&K.id&&o.set(K.id,h)}return o},[b]),L=n.useMemo(()=>D==="rtl"?[...b].reverse():b,[b,D]),f=e.selected??0,$=Math.min(f,Math.max(0,b.length-1)),I=b[$],_=n.useCallback(o=>{const h=m.get(o);h!==void 0&&h!==-1&&l?.(e.id,h)},[e.id,m,l]),G=n.useCallback(o=>{const h=m.get(o);h!==void 0&&h!==-1&&s?.(e.id,h)},[e.id,m,s]),q=n.useCallback((o,h)=>{const K=h!==void 0?h:m.get(o)??-1;K!==-1&&c?.(e.id,K)},[e.id,m,c]),Y=n.useRef(null),B=n.useRef(null),[ce,p]=n.useState(!1),[ge,fe]=n.useState(!1),ie=n.useRef(null),W=n.useRef();W.current=()=>{const o=B.current;if(!o){p(!1),fe(!1);return}const{scrollLeft:h,scrollWidth:K,clientWidth:le}=o;p(h>1),fe(h<K-le-1)};const M=n.useCallback(()=>{ie.current&&clearTimeout(ie.current),ie.current=setTimeout(()=>{W.current?.()},10)},[]),ee=n.useCallback(o=>{o.preventDefault(),o.dataTransfer.dropEffect="move";const h=o.currentTarget.getBoundingClientRect(),K=o.clientX-h.left,le=o.clientY-h.top,a=h.width,k=h.height;let N="center";if(le<40){const Z=Y.current;if(Z){const J=Z.getBoundingClientRect(),ae=o.clientX-J.left,Q=Z.querySelectorAll(".react-flex-layout-tab");let R=b.length;if(D==="rtl"){for(let E=Q.length-1;E>=0;E--){const ne=Q[E].getBoundingClientRect(),se=ne.left-J.left,ue=ne.right-J.left,F=(se+ue)/2;if(ae>F){const P=m.get(L[E].id);P!==void 0&&P!==-1&&(R=P);break}}if(R===b.length&&Q.length>0){const E=Q[0].getBoundingClientRect();if(ae>E.right-J.left){const ne=m.get(L[0].id);ne!==void 0&&ne!==-1&&(R=ne)}}}else for(let E=0;E<Q.length;E++){const ne=Q[E].getBoundingClientRect(),se=ne.left-J.left,ue=ne.right-J.left,F=(se+ue)/2;if(ae<F){const P=m.get(L[E].id);P!==void 0&&P!==-1&&(R=P);break}}N="tab",y?.(o,e.id,N,R);return}}K<a*.25?N=D==="rtl"?"right":"left":K>a*.75?N=D==="rtl"?"left":"right":le<k*.25?N="top":le>k*.75?N="bottom":N="center",y?.(o,e.id,N)},[e.id,D,b.length,L,m,y]),H=n.useCallback(o=>{u?.(o)},[u]),V=n.useCallback(o=>{g?.(o,e.id)},[e.id,g]),be=v===e.id;n.useEffect(()=>{const o=B.current;if(!o||$<0)return;let h;return h=requestAnimationFrame(()=>{const le=o.children[$];if(!le)return;const a=o.getBoundingClientRect(),k=le.getBoundingClientRect(),N=o.scrollLeft;k.left<a.left?o.scrollTo({left:N-(a.left-k.left)-10,behavior:"smooth"}):k.right>a.right&&o.scrollTo({left:N+(k.right-a.right)+10,behavior:"smooth"})}),()=>{h&&cancelAnimationFrame(h)}},[$,L.length]),n.useEffect(()=>{const o=B.current;if(!o)return;const h={current:0};h.current=requestAnimationFrame(()=>{W.current?.()}),o.addEventListener("scroll",M,{passive:!0});const K=new ResizeObserver(()=>{h.current&&cancelAnimationFrame(h.current),h.current=requestAnimationFrame(()=>{W.current?.()})});return K.observe(o),()=>{h.current&&cancelAnimationFrame(h.current),o.removeEventListener("scroll",M),K.disconnect(),ie.current&&(clearTimeout(ie.current),ie.current=null)}},[M,L.length]);const Se={...O,width:e.width?`${e.width}%`:void 0,height:e.height?`${e.height}%`:void 0,flex:`${e.flex||1} 1 0%`,minWidth:e.minWidth?`${e.minWidth}px`:void 0,minHeight:e.minHeight?`${e.minHeight}px`:void 0,maxWidth:e.maxWidth?`${e.maxWidth}px`:void 0,maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0};if(b.length===0)return null;const oe=be&&T?D==="rtl"&&(T==="left"||T==="right")?T==="left"?"right":"left":T:void 0;return S.jsxs("div",{className:`react-flex-layout-tabset ${be?"drag-over":""} ${z}`,style:Se,"data-tabset-id":e.id,"data-drop-position":oe,onDragOver:ee,onDragLeave:H,onDrop:V,children:[S.jsxs("div",{className:"react-flex-layout-tabset-header",ref:Y,children:[ce&&S.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-left",onClick:()=>{const o=B.current;o&&o.scrollBy({left:-200,behavior:"smooth"})},type:"button","aria-label":"Scroll left",children:A||S.jsx(_e,{})}),S.jsxs("div",{ref:B,className:"react-flex-layout-tabset-tabs-container",onScroll:M,children:[L.map(o=>{const h=m.get(o.id)??-1,K=h===$,le=be&&T==="tab"&&C!==null&&h===C;return S.jsxs(n.Fragment,{children:[le&&S.jsx("div",{className:"react-flex-layout-tab-drop-indicator"}),S.jsx(ve,{node:o,index:h,onSelect:_,onClose:G,onDragStart:q,onDragEnd:i,className:K?"active":"",closeIcon:w,closeButtonClassName:U})]},o.id)}),be&&T==="tab"&&C!==null&&C===b.length&&S.jsx("div",{className:"react-flex-layout-tab-drop-indicator"})]}),ge&&S.jsx("button",{className:"react-flex-layout-tabset-scroll-button react-flex-layout-tabset-scroll-right",onClick:()=>{const o=B.current;o&&o.scrollBy({left:200,behavior:"smooth"})},type:"button","aria-label":"Scroll right",children:j||S.jsx(qe,{})})]}),S.jsx("div",{className:"react-flex-layout-tabset-content",children:I&&(r?r(I):t)})]})},Te=n.memo(Ne,(e,t)=>{if(e.className!==t.className||e.direction!==t.direction||e.dragOverTabset!==t.dragOverTabset||e.dropPosition!==t.dropPosition||e.dropTargetIndex!==t.dropTargetIndex||e.factory!==t.factory||e.onTabSelect!==t.onTabSelect||e.onTabClose!==t.onTabClose||e.onTabDragStart!==t.onTabDragStart||e.onTabDragEnd!==t.onTabDragEnd||e.onDragOver!==t.onDragOver||e.onDragLeave!==t.onDragLeave||e.onDrop!==t.onDrop||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.style!==t.style||e.children!==t.children)return!1;if(e.node===t.node){if(e.node.selected!==t.node.selected)return!1}else{if(e.node.id!==t.node.id||e.node.selected!==t.node.selected||e.node.width!==t.node.width||e.node.height!==t.node.height||e.node.flex!==t.node.flex||e.node.minWidth!==t.node.minWidth||e.node.minHeight!==t.node.minHeight||e.node.maxWidth!==t.node.maxWidth||e.node.maxHeight!==t.node.maxHeight)return!1;const r=e.node.children||[],l=t.node.children||[];if(r!==l){if(r.length!==l.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==l[s]){const c=r[s],i=l[s];if(c.id!==i.id||c.type!==i.type||c.name!==i.name||c.component!==i.component||c.enableClose!==i.enableClose||c.enableDrag!==i.enableDrag)return!1}}}return!0});Te.displayName="MemoizedTabSet";const Je=({direction:e,onResize:t,onResizeStart:r,size:l=8,className:s="",style:c={},customStyles:i={}})=>{const[y,u]=n.useState(!1),g=n.useRef(0),v=n.useRef(0),T=n.useRef(!1),C=n.useRef(null),D=n.useRef(null),z=n.useCallback(A=>{A.preventDefault(),A.stopPropagation(),u(!0),g.current=e==="horizontal"?A.clientX:A.clientY,v.current=g.current,r?.();const j=m=>{v.current=e==="horizontal"?m.clientX:m.clientY,T.current||(T.current=!0,requestAnimationFrame(()=>{T.current=!1;const L=v.current-g.current;t(L)}))},b=()=>{u(!1),document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",b),C.current=null,D.current=null,T.current=!1};document.addEventListener("mousemove",j),document.addEventListener("mouseup",b),C.current=j,D.current=b},[e,t,r]),O={backgroundColor:"#ffffff",border:"none",outline:"none"},w=n.useMemo(()=>y&&i.active?i.active:i.default?i.default:O,[y,i.active,i.default]),U=n.useMemo(()=>{const A=e==="horizontal";return{...c,width:A?`${l}px`:"100%",height:A?"100%":`${l}px`,minWidth:A?`${l}px`:void 0,minHeight:A?void 0:`${l}px`,flexShrink:0,cursor:A?"col-resize":"row-resize",...w,transition:y?"none":"all 0.2s ease"}},[e,l,c,w,y]);return n.useEffect(()=>()=>{C.current&&document.removeEventListener("mousemove",C.current),D.current&&document.removeEventListener("mouseup",D.current),T.current=!1},[]),S.jsx("div",{className:`react-flex-layout-splitter ${s}`,style:U,onMouseDown:z})},Ce=n.memo(Je,(e,t)=>e.direction===t.direction&&e.size===t.size&&e.onResize===t.onResize&&e.onResizeStart===t.onResizeStart&&e.className===t.className&&e.style===t.style&&e.customStyles===t.customStyles),Xe=(e,t)=>({global:{enableClose:!0,enableDrag:!0,enableResize:!0,splitterSize:8,tabOverlapLength:0,direction:"ltr",...t},layout:e}),ze=(e,t,r,l)=>({id:e,type:"tab",component:t,name:r,config:l,enableClose:!0,enableDrag:!0}),xe=(e,t,r=0)=>({id:e,type:"tabset",children:t,selected:r,enableClose:!0,enableDrag:!0}),$e=(e,t,r,l)=>({id:e,type:"row",children:Le(t),width:r,height:l,enableResize:!0}),He=(e,t,r,l)=>({id:e,type:"column",children:Le(t),width:r,height:l,enableResize:!0}),re=(e,t)=>{if(e.id===t)return e;if(e.children)for(const r of e.children){const l=re(r,t);if(l)return l}return null},Oe=(e,t)=>{if(!e.children)return null;for(const r of e.children)if(r.id===t)return e;for(const r of e.children){const l=Oe(r,t);if(l)return l}return null},X=(e,t,r)=>{if(e.id===t)return r===null?null:Object.keys(r).some(s=>{const c=s;return e[c]!==r[c]})?{...e,...r}:e;if(e.children){let l=null;const s=e.children;for(let c=0;c<s.length;c++){const i=s[c],y=X(i,t,r);y!==i&&l===null&&(l=s.slice(0,c)),l!==null&&y!==null&&l.push(y)}return l===null?e:{...e,children:l}}return e},De=(e,t)=>{if(!e.children)return e;let r=null;const l=e.children;for(let s=0;s<l.length;s++){const c=l[s];if(c.id===t){r===null&&(r=l.slice(0,s));continue}const i=De(c,t);i!==c&&r===null&&(r=l.slice(0,s)),r!==null&&r.push(i)}return r===null?e:{...e,children:r}},Le=e=>e.map(t=>({...t,flex:t.flex||1/e.length})),he=e=>{if(e.type==="tabset"&&(!e.children||e.children.length===0))return null;if(e.children){const t=e.children,r=t.length;let l=null;for(let i=0;i<t.length;i++){const y=t[i],u=he(y);u!==y&&l===null&&(l=t.slice(0,i)),l!==null&&u!==null&&l.push(u)}const s=l??t,c=s.length<r;if(s.length===0)return null;if((e.type==="row"||e.type==="column")&&s.length>0){const i=s.reduce((u,g)=>u+(g.flex||0),0);if(c||i<.999||s.length===1){let u;if(s.length===1)u=s.map(g=>({...g,flex:1}));else if(i===0||i<.001){const g=1/s.length;u=s.map(v=>({...v,flex:g}))}else{const g=1/i;u=s.map(v=>({...v,flex:(v.flex||0)*g}))}return{...e,children:u}}if(s.length!==r||s.some((u,g)=>u!==t[g]))return{...e,children:s}}if(l!==null)return{...e,children:s}}return e},Ae=(e,t,r=null)=>{if(!e.children)return null;for(const l of e.children){if(l.id===t)return r||e;if(l.children){const s=Ae(l,t,e);if(s)return s}}return null},We=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.type==="tabset"&&r.children&&r.children.find(s=>s.id===t))return r;if(r.children){const l=We(r,t);if(l)return l}}return null},Me=(e,t,r)=>{const l=re(e,t);if(!l||l.type!=="tabset")return null;const c=[...l.children||[],r],i={...l,children:c,selected:c.length-1};return X(e,t,i)},Ue=(e,t)=>{const r=We(e,t);if(!r||r.type!=="tabset")return{layout:e,restoreData:null};const l=r.children?.find(T=>T.id===t);if(!l||l.type!=="tab")return{layout:e,restoreData:null};const s=r.children?.findIndex(T=>T.id===t),c=r.children?.filter(T=>T.id!==t);if(!c||c.length===0){const T=De(e,r.id),C={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:s!==void 0?s:0,config:l.config};return{layout:T,restoreData:C}}const i=r.selected??0;let y=i;s!==void 0&&s!==-1&&(s<=i&&(y=Math.max(0,i-1)),y=Math.min(y,c.length-1));const u={...r,children:c,selected:c.length>0?y:void 0},g=X(e,r.id,u),v={tabId:l.id,component:l.component||"",name:l.name||"",tabsetId:r.id,tabIndex:s!==void 0?s:0,config:l.config};return{layout:g,restoreData:v}},Ye=(e,t,r)=>{if(re(e,t.tabId))return e;let s=re(e,t.tabsetId);if(!s||s.type!=="tabset"){if(!r)return null;const y=Ae(r,t.tabsetId);if(!y)return null;const u=re(e,y.id);if(!u||!u.children)return null;const g=u.children.find(v=>v.id===t.tabsetId);if(g)s=g;else{const v=xe(t.tabsetId,[]),T=[...u.children,v],C={...u,children:T},D=X(e,u.id,C);if(!D||(e=D,s=re(e,t.tabsetId),!s||s.type!=="tabset"))return null}}const c=ze(t.tabId,t.component,t.name,t.config);return Me(e,t.tabsetId,c)},Ve=(e,t)=>re(e,t)!==null,Ge=(e,t)=>{const r=n.useRef({}),l=n.useRef({}),s=n.useRef(e),c=n.useRef(t);n.useEffect(()=>{s.current=e},[e]),n.useEffect(()=>{c.current=t},[t]);const i=n.useCallback((u,g,v)=>{if(!c.current)return;const T=s.current,C=Fe(T.layout,u);if(!C||!C.children)return;const D=C.children.findIndex(I=>I.id===u),z=D+1;if(z>=C.children.length)return;const O=`${u}-${v}`;if(!r.current[O]){const I=C.children[D],_=C.children[z];r.current[O]={current:I.flex||1,sibling:_.flex||1}}const w=r.current[O],U=w.current+w.sibling,A=v==="horizontal"?window.innerWidth:window.innerHeight,j=w.current/U*A,b=w.sibling/U*A,m=100;let L=j+g,f=b-g;if(L<m){const I=m-L;L=m,f-=I}if(f<m){const I=m-f;f=m,L-=I}const $=L+f;if($>0){const I=L/$*U,_=f/$*U,G=l.current[O],q=1e-4;if(G&&Math.abs(G.current-I)<q&&Math.abs(G.sibling-_)<q)return;const Y=C.children.slice(),B=Y[D],ce=Y[z];Y[D]={...B,flex:I},Y[z]={...ce,flex:_};const p=X(T.layout,C.id,{children:Y});p&&(l.current[O]={current:I,sibling:_},c.current({...T,layout:p}))}},[]),y=n.useCallback((u,g)=>{const v=`${u}-${g}`;delete r.current[v],delete l.current[v]},[]);return{handleResize:i,resetResize:y}},Fe=(e,t)=>{if(!e.children)return null;for(const r of e.children){if(r.id===t)return e;const l=Fe(r,t);if(l)return l}return null},Qe=(e,t)=>{const[r,l]=n.useState(null),[s,c]=n.useState(null),[i,y]=n.useState("center"),[u,g]=n.useState(null),v=n.useRef(null),T=n.useRef(e),C=n.useRef(t),D=n.useRef(i),z=n.useRef(u);n.useEffect(()=>{T.current=e},[e]),n.useEffect(()=>{C.current=t},[t]),n.useEffect(()=>{D.current=i},[i]),n.useEffect(()=>{z.current=u},[u]);const O=n.useCallback((b,m)=>{const L={tabsetId:b,tabIndex:m};l(L),v.current=L},[]),w=n.useCallback(()=>{l(null),v.current=null,c(null),g(null)},[]),U=n.useCallback((b,m,L="center",f)=>{b.preventDefault(),b.dataTransfer.dropEffect="move",c(m),y(L),f!==void 0?g(f):L!=="tab"&&g(null)},[]),A=n.useCallback(b=>{b.currentTarget===b.target&&setTimeout(()=>{c(null),g(null)},50)},[]),j=n.useCallback((b,m)=>{b.preventDefault();const L=v.current,f=T.current,$=C.current,I=D.current,_=z.current;if(!L||!$)return;const{tabsetId:G,tabIndex:q}=L;if(G===m&&I==="tab"&&_!==null){const W=re(f.layout,G);if(!W||!W.children)return;const M=W.children[q];if(!M||q===_)return;const ee=[...W.children];ee.splice(q,1),ee.splice(_,0,M);let H=W.selected??0;q<H&&_>=H?H=Math.max(0,H-1):q>H&&_<=H?H=Math.min(H+1,ee.length-1):q===H&&(H=_);const V=X(f.layout,G,{children:ee,selected:H});V&&$({...f,layout:V,metadata:f.metadata}),l(null),c(null),g(null);return}if(G===m&&I!=="tab")return;const Y=re(f.layout,G),B=re(f.layout,m);if(!Y||!B||!Y.children||!B.children)return;const ce=Y.children[q];if(!ce)return;let p=f.layout;const ge=Y.children.filter((W,M)=>M!==q),fe=X(p,G,{children:ge,selected:Math.min(Y.selected||0,ge.length-1)});if(!fe)return;if(p=fe,I==="center"){const W=X(p,m,{children:[...B.children||[],ce],selected:B.children?.length||0});if(!W)return;p=W}else{const W=xe(`${m}-split-${Date.now()}`,[ce]),M=Oe(p,m);if(M){const ee=M.children?.findIndex(H=>H.id===m)||0;if(I==="left"||I==="right"){const H=$e(`${m}-row-${Date.now()}`,[I==="left"?W:B,I==="left"?B:W]),V=X(p,M.id,{children:[...M.children?.slice(0,ee)||[],H,...M.children?.slice(ee+1)||[]]});if(!V)return;p=V}else if(I==="top"||I==="bottom"){const H=He(`${m}-column-${Date.now()}`,[I==="top"?W:B,I==="top"?B:W]),V=X(p,M.id,{children:[...M.children?.slice(0,ee)||[],H,...M.children?.slice(ee+1)||[]]});if(!V)return;p=V}}}const ie=he(p);ie&&$({...f,layout:ie,metadata:f.metadata}),l(null),c(null)},[]);return{draggedTab:r,dragOverTabset:s,dropPosition:i,dropTargetIndex:u,handleDragStart:O,handleDragEnd:w,handleDragOver:U,handleDragLeave:A,handleDrop:j}},Ze="react-flex-layout";class we{storageKey;autoSave;debounceMs;saveTimeout=null;lastSavedString=null;isAvailable;constructor(t={}){this.storageKey=`${Ze}-${t.key||"default"}`,this.autoSave=t.autoSave!==!1,this.debounceMs=t.debounceMs||500,this.isAvailable=Be()}save(t){if(this.isAvailable)try{const r=JSON.stringify(t);if(r===this.lastSavedString)return;localStorage.setItem(this.storageKey,r),this.lastSavedString=r}catch{}}load(){if(!this.isAvailable)return null;try{const t=localStorage.getItem(this.storageKey);if(t)return this.lastSavedString=t,JSON.parse(t)}catch{}return null}clear(){if(this.isAvailable)try{localStorage.removeItem(this.storageKey),this.lastSavedString=null}catch{}}exists(){return this.isAvailable?localStorage.getItem(this.storageKey)!==null:!1}debouncedSave(t){this.autoSave&&this.isAvailable&&(this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.save(t)},this.debounceMs))}getStorageKey(){return this.storageKey}isAutoSaveEnabled(){return this.autoSave}cancel(){this.saveTimeout&&(clearTimeout(this.saveTimeout),this.saveTimeout=null)}}const Re=e=>new we(e),Be=()=>{try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}},pe=(e,t={})=>{const{onLoad:r,onSave:l,onError:s,...c}=t,i=n.useRef(null),[y,u]=n.useState(e),[g,v]=n.useState(!1),[T,C]=n.useState(!1);n.useEffect(()=>{if(i.current)try{i.current.cancel?.()}catch{}i.current=new we(c),C(!0)},[c.key,c.autoSave,c.debounceMs]),n.useEffect(()=>{if(!i.current||g)return;const f=i.current.load();f?(u(f),v(!0),r?.(f)):v(!0)},[g,r]);const D=n.useRef(),z=n.useMemo(()=>JSON.stringify(y.layout),[y.layout]),O=n.useMemo(()=>JSON.stringify(e.layout),[e.layout]),w=n.useMemo(()=>y.metadata?JSON.stringify(y.metadata):void 0,[y.metadata]),U=n.useMemo(()=>e.metadata?JSON.stringify(e.metadata):void 0,[e.metadata]);n.useEffect(()=>{if(!(!g||!i.current)){if(D.current!==O&&z!==O){const f={...e};e.global&&(f.global={...e.global}),u(f),D.current=O,i.current.isAutoSaveEnabled()?i.current.debouncedSave(f):i.current.save(f);return}e.metadata&&w!==U&&u(f=>({...f,metadata:e.metadata}))}},[g,i,e,z,O,w,U]);const A=n.useCallback(f=>{if(i.current)try{i.current.isAutoSaveEnabled()?i.current.debouncedSave(f):i.current.save(f),l?.(f)}catch($){s?.($)}},[l,s]),j=n.useCallback(f=>{const $={...f};f.global&&($.global={...f.global}),u($),A($)},[A]),b=n.useCallback(()=>{if(i.current)try{i.current.clear()}catch(f){s?.(f)}},[s]),m=n.useCallback(()=>i.current?.exists()??!1,[]),L=n.useCallback(()=>i.current?.getStorageKey()??"",[]);return{model:y,updateModel:j,clearStorage:b,hasStoredData:m,getStorageKey:L,isLoaded:g,hasStorage:T}},Ke=n.forwardRef(({model:e,factory:t,onModelChange:r,onAction:l,className:s="",style:c={},storage:i,closeIcon:y,closeButtonClassName:u,scrollLeftIcon:g,scrollRightIcon:v},T)=>{const[C,D]=n.useState(e),[z,O]=n.useState(null),{model:w,updateModel:U,isLoaded:A}=pe(e,{key:i?.key,autoSave:i?.autoSave,debounceMs:i?.debounceMs,onLoad:a=>{r?r(a):D(a)}}),j=i?.enabled?w:r?e:C,b=n.useRef(r),m=n.useRef(i),L=n.useRef(U);n.useEffect(()=>{b.current=r},[r]),n.useEffect(()=>{m.current=i},[i]),n.useEffect(()=>{L.current=U},[U]);const f=n.useCallback(a=>{m.current?.enabled?(L.current(a),b.current&&b.current(a)):b.current?b.current(a):D(a)},[]),{handleResize:$,resetResize:I}=Ge(j,f),_=n.useRef(new Map),G=n.useCallback((a,k,N)=>{const te=`${a}-${k}-${N?"rtl":"ltr"}`;return _.current.has(te)||_.current.set(te,{onResize:d=>{const Z=N?-d:d;$(a,Z,k)},onResizeStart:()=>{I(a,k)}}),_.current.get(te)},[$,I]),{dragOverTabset:q,dropPosition:Y,dropTargetIndex:B,handleDragStart:ce,handleDragEnd:p,handleDragOver:ge,handleDragLeave:fe,handleDrop:ie}=Qe(j,f),W=n.useRef(w);n.useEffect(()=>{W.current=w},[w]);const M=n.useRef(C);n.useEffect(()=>{M.current=C},[C]);const ee=n.useRef(e);n.useEffect(()=>{ee.current=e},[e]);const H=n.useRef(l);n.useEffect(()=>{H.current=l},[l]);const V=n.useCallback(a=>{if(m.current?.enabled){const k=W.current;if(a.type==="changeDirection"){const{direction:d}=a.payload;O(d)}const te=(d=>{switch(a.type){case"selectTab":const{nodeId:Z,tabIndex:J}=a.payload,ae=X(d.layout,Z,{selected:J});return!ae||ae===d.layout?d:{...d,layout:ae};case"removeNode":const{nodeId:Q,tabIndex:R}=a.payload,E=re(d.layout,Q);if(E&&E.children){const F=E.children.filter((me,ke)=>ke!==R),P=E.selected??0;let de=P;R<=P&&(de=Math.max(0,P-1)),de=Math.min(de,F.length-1);const Ie={...E,children:F,selected:F.length>0?de:void 0},ye=X(d.layout,Q,Ie);if(ye){const me=he(ye);if(me)return{...d,layout:me}}}return d;case"closeTabset":const{nodeId:ne}=a.payload,se=X(d.layout,ne,null);if(se){const F=he(se);if(F)return{...d,layout:F}}return d;case"changeDirection":const{direction:ue}=a.payload;return{...d,global:{...d.global,direction:ue}};default:return d}})(k);L.current(te),b.current&&b.current(te),H.current?.(a)}else{if(a.type==="changeDirection"&&b.current){const{direction:k}=a.payload,N=ee.current,te={...N,global:{...N.global,direction:k}};b.current(te)}H.current?.(a)}if(!m.current?.enabled&&!b.current){const k=M.current,te=(d=>{switch(a.type){case"selectTab":const{nodeId:Z,tabIndex:J}=a.payload,ae=X(d.layout,Z,{selected:J});return!ae||ae===d.layout?d:{...d,layout:ae};case"removeNode":const{nodeId:Q,tabIndex:R}=a.payload,E=re(d.layout,Q);if(E&&E.children){const F=E.children.filter((me,ke)=>ke!==R),P=E.selected??0;let de=P;R<=P&&(de=Math.max(0,P-1)),de=Math.min(de,F.length-1);const Ie={...E,children:F,selected:F.length>0?de:void 0},ye=X(d.layout,Q,Ie);if(ye){const me=he(ye);if(me)return{...d,layout:me}}}return d;case"closeTabset":const{nodeId:ne}=a.payload,se=X(d.layout,ne,null);if(se){const F=he(se);if(F)return{...d,layout:F}}return d;case"changeDirection":const{direction:ue}=a.payload;return{...d,global:{...d.global,direction:ue}};default:return d}})(k);D(te)}},[]);n.useImperativeHandle(T,()=>({handleAction:V}),[V]);const be=n.useCallback((a,k)=>{V({type:"selectTab",payload:{nodeId:a,tabIndex:k}})},[V]),Se=n.useCallback((a,k)=>{V({type:"removeNode",payload:{nodeId:a,tabIndex:k}})},[V]);let oe;i?.enabled?z!==null?oe=z:oe=w?.global?.direction||"ltr":oe=j.global?.direction||"ltr";const o=j.global?.splitterSize||8,h=n.useCallback(a=>{switch(a.type){case"tabset":return S.jsx(Te,{node:a,factory:t,onTabSelect:be,onTabClose:Se,onTabDragStart:ce,onTabDragEnd:p,onDragOver:ge,onDragLeave:fe,onDrop:ie,dragOverTabset:q,dropPosition:q===a.id?Y:void 0,dropTargetIndex:q===a.id?B:void 0,direction:oe,closeIcon:y,closeButtonClassName:u,scrollLeftIcon:g,scrollRightIcon:v},a.id);case"row":const k=oe==="rtl",N=a.children||[],te=k?[...N].reverse():N;return S.jsx("div",{className:"react-flex-layout-row",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:te.map((d,Z)=>{const J=Z+1;if(!(J<te.length))return S.jsx(n.Fragment,{children:h(d)},d.id);const Q=k?N.length-1-Z:Z,R=k?N.length-1-J:J,E=Math.min(Q,R);if(Math.max(Q,R)!==E+1)return S.jsx(n.Fragment,{children:h(d)},d.id);const se=N[E],ue=k&&Q>R,F=G(se.id,"horizontal",ue);return S.jsxs(n.Fragment,{children:[h(d),S.jsx(Ce,{direction:"horizontal",onResize:F.onResize,onResizeStart:F.onResizeStart,size:o})]},d.id)})},a.id);case"column":return S.jsx("div",{className:"react-flex-layout-column",style:{width:a.width?`${a.width}%`:void 0,height:a.height?`${a.height}%`:void 0,flex:`${a.flex||1} 1 0%`,minWidth:a.minWidth?`${a.minWidth}px`:void 0,minHeight:a.minHeight?`${a.minHeight}px`:void 0,maxWidth:a.maxWidth?`${a.maxWidth}px`:void 0,maxHeight:a.maxHeight?`${a.maxHeight}px`:void 0},children:a.children?.map((d,Z)=>{const J=Z<(a.children?.length||0)-1?G(d.id,"vertical"):null;return S.jsxs(n.Fragment,{children:[h(d),J&&S.jsx(Ce,{direction:"vertical",onResize:J.onResize,onResizeStart:J.onResizeStart,size:o})]},d.id)})},a.id);case"tab":return t(a);default:return null}},[oe,o,t,be,Se,$,ce,p,ge,fe,ie,q,Y,y,u,G]);n.useEffect(()=>{!i?.enabled&&z!==null&&O(null)},[i?.enabled,z]),n.useEffect(()=>{i?.enabled&&z!==null&&(w?.global?.direction||"ltr")===z&&O(null)},[i?.enabled,z,w?.global?.direction]);const K=n.useMemo(()=>h(j.layout),[h,j.layout]),le={...c,height:"100%",width:"100%"};return i?.enabled&&!A?S.jsx("div",{className:`react-flex-layout ${s}`,style:{...le,display:"flex",alignItems:"center",justifyContent:"center"},children:S.jsx("div",{children:"Loading layout..."})}):S.jsx("div",{className:`react-flex-layout ${s}`,style:le,dir:oe,children:K})});Ke.displayName="Layout";const je=n.memo(ve,(e,t)=>!(e.className!==t.className||e.style!==t.style||e.closeIcon!==t.closeIcon||e.closeButtonClassName!==t.closeButtonClassName||e.index!==t.index||e.onSelect!==t.onSelect||e.onClose!==t.onClose||e.onDragStart!==t.onDragStart||e.onDragEnd!==t.onDragEnd||e.node.id!==t.node.id||e.node.name!==t.node.name));je.displayName="MemoizedTab",x.DefaultCloseIcon=Ee,x.Layout=Ke,x.LayoutStorage=we,x.MemoizedTab=je,x.MemoizedTabSet=Te,x.Splitter=Ce,x.Tab=ve,x.TabSet=Ne,x.addTabToTabset=Me,x.calculateFlexValues=Le,x.createColumn=He,x.createLayoutModel=Xe,x.createLayoutStorage=Re,x.createRow=$e,x.createTab=ze,x.createTabSet=xe,x.findNodeById=re,x.isLocalStorageAvailable=Be,x.removeEmptyTabsets=he,x.removeNodeById=De,x.removeTab=Ue,x.restoreTab=Ye,x.tabExists=Ve,x.updateNodeById=X,x.useLayoutStorage=pe,Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})}));
